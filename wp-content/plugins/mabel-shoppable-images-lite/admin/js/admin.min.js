jQuery(document).ready(function(){new Core.Admin.Main(jQuery(document.body))});
var Core;!function(t){!function(i){var e=function(){function e(i){var e=t.Admin.Helpers.Context.getSlug();this.slug=e,this.parent=i,this.navlinks=this.parent.find(".nav-tab-wrapper a"),this.tabs=this.parent.find(".tab"),this.form=this.parent.find("#"+e+"-form"),this.settingsKey=t.Admin.Helpers.Context.getSettingsKey(),this.currentTab=this.parent.find(".nav-tab-active").data("tab"),this.sidebars=this.parent.find(".mabel-sidebar"),this.mainSidebar=this.sidebars.filter('[data-sidebar-for="main"]'),this.initColorPickers(),this.initRangeSliders(),this.initTabs(),this.initAccordions(),this.initDependencies(),this.toggleSidebars(),this.initChangeSettings(),this.initEvents()}return e.prototype.initRangeSliders=function(){jQuery('input[type="range"]').each(function(t,i){var e=jQuery(i);e.rangeslider({polyfill:!1,onSlideEnd:function(t,i){e.val(i)}})})},e.prototype.initAccordions=function(){this.parent.find(".mabel-accordion button").on("click",function(t){t.preventDefault();var i=jQuery(this);i.next().stop(!0,!1).slideToggle(125),i.toggleClass("active")})},e.prototype.initEvents=function(){var i=this,e=window.tb_remove;window.tb_remove=function(){e(),t.Admin.Dispatcher.publish("modal:closed"),i.saveSettings()},t.Admin.Dispatcher.subscribe("settings:save",function(){i.saveSettings()})},e.prototype.initColorPickers=function(){var e=this,n=0;e.parent.find(".color-picker").wpColorPicker({change:function(s,a){clearTimeout(n),n=setTimeout(function(){i.Dispatcher.publish("settings:changed",t.Admin.Helpers.Context.getSettings()),e.saveSettings()},250)}})},e.prototype.initChangeSettings=function(){var e=this;this.form.find('select, input[type=range], input[type="text"], textarea, input[type=checkbox]').not(".skip-save").on("change",function(){i.Dispatcher.publish("settings:changed",t.Admin.Helpers.Context.getSettings()),e.saveSettings()}),this.form.find('input[type="number"]').not(".skip-save").each(function(t,i){var n=jQuery(i),s=0;n.on("change keyup keydown input",function(){clearTimeout(s),s=setTimeout(function(){e.saveSettings()},600)})})},e.prototype.saveSettings=function(){var i=this;this.parent.find(".all-settings-saved").hide(),this.parent.find(".saving-settings").show();var e=this.form.serialize();jQuery.post("options.php",e).done(function(){i.parent.find(".all-settings-saved").show(),i.parent.find(".saving-settings").hide(),t.Admin.Dispatcher.publish("settings:saved",e)})},e.prototype.initDependencies=function(){var t=this;this.parent.find('[name*="'+this.settingsKey+'"]').each(function(i,e){var n=jQuery(e),s=n.data("dependency");if(s){var a=t.parent.find('[name="'+t.settingsKey+"["+s.element_id+']"]').not(".skip-dependency");a&&(a.on("change",function(){var t=a.val(),i=!1;if(a.is(":checkbox")){var e=a.is(":checked");t==s.value&&e&&(i=!0)}else t==s.value&&(i=!0);i?n.closest("tr").show():n.closest("tr").hide()}),a.trigger("change"))}})},e.prototype.initTabs=function(){var i=this,e=this.parent.find(".nav-tab-wrapper a");this.parent.find(".tab");e.on("click",function(t){t.preventDefault(),i.setTab(jQuery(t.currentTarget).data("tab"))}),t.Admin.Dispatcher.subscribe("tab:activate",function(t){i.setTab(t)})},e.prototype.setTab=function(i){var e=this.parent.find('[data-tab="'+i+'"]');this.navlinks.removeClass("nav-tab-active"),e.addClass("nav-tab-active"),this.tabs.hide(),this.parent.find(".tab-"+i).show(),t.Admin.Dispatcher.publish("tab:changed",i),this.currentTab=i,this.toggleSidebars()},e.prototype.toggleSidebars=function(){this.sidebars.hide();var t=this.sidebars.filter('[data-sidebar-for="'+this.currentTab+'"]');t.length&&!t.is(":empty")?t.show():this.mainSidebar.show()},e}();i.Main=e}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var Core;!function(i){!function(i){var t=function(){function i(){}return i.subscribe=function(i,t){this.hOP.call(this.topics,i)||(this.topics[i]=[]);var o=this.topics[i].push(t)-1;return{remove:function(){delete this.topics[i][o]}}},i.publish=function(i,t){this.hOP.call(this.topics,i)&&this.topics[i].forEach(function(i){i(void 0!=t?t:{})})},i.topics=[],i.hOP=[].hasOwnProperty,i}();i.Dispatcher=t}(i.Admin||(i.Admin={}))}(Core||(Core={}));
var Core;!function(e){!function(e){!function(e){var t=function(){function e(e,t){var i=this;this.onSelect=t,this.initMediaSelector(),e.on("click",function(e){e.preventDefault(),i.mediaSelector.open()})}return e.prototype.initMediaSelector=function(){var e=this;this.mediaSelector=window.wp.media.frames.file_frame=window.wp.media({multiple:!1,title:"Choose or upload an image",button:{text:"Use this image"}}),this.mediaSelector.on("select",function(){var t=e.mediaSelector.state().get("selection").first().toJSON();e.onSelect(t)})},e}();e.MediaSelector=t}(e.Components||(e.Components={}))}(e.Admin||(e.Admin={}))}(Core||(Core={}));
!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==typeof exports?module.exports=t(require("jquery")):t(jQuery)}(function(t){"use strict";function i(t,i){var e=Array.prototype.slice.call(arguments,2);return setTimeout(function(){return t.apply(null,e)},i)}function e(t,i){return i=i||100,function(){if(!t.debouncing){var e=Array.prototype.slice.apply(arguments);t.lastReturnVal=t.apply(window,e),t.debouncing=!0}return clearTimeout(t.debounceTimeout),t.debounceTimeout=setTimeout(function(){t.debouncing=!1},i),t.lastReturnVal}}function n(t){return t&&(0===t.offsetWidth||0===t.offsetHeight||!1===t.open)}function s(t){for(var i=[],e=t.parentNode;n(e);)i.push(e),e=e.parentNode;return i}function o(t,i){function e(t){void 0!==t.open&&(t.open=!t.open)}var n=s(t),o=n.length,r=[],h=t[i];if(o){for(var a=0;a<o;a++)r[a]=n[a].style.cssText,n[a].style.setProperty?n[a].style.setProperty("display","block","important"):n[a].style.cssText+=";display: block !important",n[a].style.height="0",n[a].style.overflow="hidden",n[a].style.visibility="hidden",e(n[a]);h=t[i];for(var l=0;l<o;l++)n[l].style.cssText=r[l],e(n[l])}return h}function r(t,i){var e=parseFloat(t);return Number.isNaN(e)?i:e}function h(t){return t.charAt(0).toUpperCase()+t.substr(1)}function a(n,s){if(this.$window=t(window),this.$document=t(document),this.$element=t(n),this.options=t.extend({},p,s),this.polyfill=this.options.polyfill,this.orientation=this.$element[0].getAttribute("data-orientation")||this.options.orientation,this.onInit=this.options.onInit,this.onSlide=this.options.onSlide,this.onSlideEnd=this.options.onSlideEnd,this.DIMENSION=f.orientation[this.orientation].dimension,this.DIRECTION=f.orientation[this.orientation].direction,this.DIRECTION_STYLE=f.orientation[this.orientation].directionStyle,this.COORDINATE=f.orientation[this.orientation].coordinate,this.polyfill&&u)return!1;this.identifier="js-"+l+"-"+d++,this.startEvent=this.options.startEvent.join("."+this.identifier+" ")+"."+this.identifier,this.moveEvent=this.options.moveEvent.join("."+this.identifier+" ")+"."+this.identifier,this.endEvent=this.options.endEvent.join("."+this.identifier+" ")+"."+this.identifier,this.toFixed=(this.step+"").replace(".","").length-1,this.$fill=t('<div class="'+this.options.fillClass+'" />'),this.$handle=t('<div class="'+this.options.handleClass+'" />'),this.$range=t('<div class="'+this.options.rangeClass+" "+this.options[this.orientation+"Class"]+'" id="'+this.identifier+'" />').insertAfter(this.$element).prepend(this.$fill,this.$handle),this.$element.css({position:"absolute",width:"1px",height:"1px",overflow:"hidden",opacity:"0"}),this.handleDown=t.proxy(this.handleDown,this),this.handleMove=t.proxy(this.handleMove,this),this.handleEnd=t.proxy(this.handleEnd,this),this.init();var o=this;this.$window.on("resize."+this.identifier,e(function(){i(function(){o.update(!1,!1)},300)},20)),this.$document.on(this.startEvent,"#"+this.identifier+":not(."+this.options.disabledClass+")",this.handleDown),this.$element.on("change."+this.identifier,function(t,i){if(!i||i.origin!==o.identifier){var e=t.target.value,n=o.getPositionFromValue(e);o.setPosition(n)}})}Number.isNaN=Number.isNaN||function(t){return"number"==typeof t&&t!==t};var l="rangeslider",d=0,u=function(){var t=document.createElement("input");return t.setAttribute("type","range"),"text"!==t.type}(),p={polyfill:!0,orientation:"horizontal",rangeClass:"rangeslider",disabledClass:"rangeslider--disabled",activeClass:"rangeslider--active",horizontalClass:"rangeslider--horizontal",verticalClass:"rangeslider--vertical",fillClass:"rangeslider__fill",handleClass:"rangeslider__handle",startEvent:["mousedown","touchstart","pointerdown"],moveEvent:["mousemove","touchmove","pointermove"],endEvent:["mouseup","touchend","pointerup"]},f={orientation:{horizontal:{dimension:"width",direction:"left",directionStyle:"left",coordinate:"x"},vertical:{dimension:"height",direction:"top",directionStyle:"bottom",coordinate:"y"}}};a.prototype.init=function(){this.update(!0,!1),this.onInit&&"function"==typeof this.onInit&&this.onInit()},a.prototype.update=function(t,i){t=t||!1,t&&(this.min=r(this.$element[0].getAttribute("min"),0),this.max=r(this.$element[0].getAttribute("max"),100),this.value=r(this.$element[0].value,Math.round(this.min+(this.max-this.min)/2)),this.step=r(this.$element[0].getAttribute("step"),1)),this.handleDimension=o(this.$handle[0],"offset"+h(this.DIMENSION)),this.rangeDimension=o(this.$range[0],"offset"+h(this.DIMENSION)),this.maxHandlePos=this.rangeDimension-this.handleDimension,this.grabPos=this.handleDimension/2,this.position=this.getPositionFromValue(this.value),this.$element[0].disabled?this.$range.addClass(this.options.disabledClass):this.$range.removeClass(this.options.disabledClass),this.setPosition(this.position,i)},a.prototype.handleDown=function(t){if(t.preventDefault(),this.$document.on(this.moveEvent,this.handleMove),this.$document.on(this.endEvent,this.handleEnd),this.$range.addClass(this.options.activeClass),!((" "+t.target.className+" ").replace(/[\n\t]/g," ").indexOf(this.options.handleClass)>-1)){var i=this.getRelativePosition(t),e=this.$range[0].getBoundingClientRect()[this.DIRECTION],n=this.getPositionFromNode(this.$handle[0])-e,s="vertical"===this.orientation?this.maxHandlePos-(i-this.grabPos):i-this.grabPos;this.setPosition(s),i>=n&&i<n+this.handleDimension&&(this.grabPos=i-n)}},a.prototype.handleMove=function(t){t.preventDefault();var i=this.getRelativePosition(t),e="vertical"===this.orientation?this.maxHandlePos-(i-this.grabPos):i-this.grabPos;this.setPosition(e)},a.prototype.handleEnd=function(t){t.preventDefault(),this.$document.off(this.moveEvent,this.handleMove),this.$document.off(this.endEvent,this.handleEnd),this.$range.removeClass(this.options.activeClass),this.$element.trigger("change",{origin:this.identifier}),this.onSlideEnd&&"function"==typeof this.onSlideEnd&&this.onSlideEnd(this.position,this.value)},a.prototype.cap=function(t,i,e){return t<i?i:t>e?e:t},a.prototype.setPosition=function(t,i){var e,n;void 0===i&&(i=!0),e=this.getValueFromPosition(this.cap(t,0,this.maxHandlePos)),n=this.getPositionFromValue(e),this.$fill[0].style[this.DIMENSION]=n+this.grabPos+"px",this.$handle[0].style[this.DIRECTION_STYLE]=n+"px",this.setValue(e),this.position=n,this.value=e,i&&this.onSlide&&"function"==typeof this.onSlide&&this.onSlide(n,e)},a.prototype.getPositionFromNode=function(t){for(var i=0;null!==t;)i+=t.offsetLeft,t=t.offsetParent;return i},a.prototype.getRelativePosition=function(t){var i=h(this.COORDINATE),e=this.$range[0].getBoundingClientRect()[this.DIRECTION],n=0;return void 0!==t.originalEvent["client"+i]?n=t.originalEvent["client"+i]:t.originalEvent.touches&&t.originalEvent.touches[0]&&void 0!==t.originalEvent.touches[0]["client"+i]?n=t.originalEvent.touches[0]["client"+i]:t.currentPoint&&void 0!==t.currentPoint[this.COORDINATE]&&(n=t.currentPoint[this.COORDINATE]),n-e},a.prototype.getPositionFromValue=function(t){var i;return i=(t-this.min)/(this.max-this.min),Number.isNaN(i)?0:i*this.maxHandlePos},a.prototype.getValueFromPosition=function(t){var i,e;return i=t/(this.maxHandlePos||1),e=this.step*Math.round(i*(this.max-this.min)/this.step)+this.min,Number(e.toFixed(this.toFixed))},a.prototype.setValue=function(t){t===this.value&&""!==this.$element[0].value||this.$element.val(t).trigger("input",{origin:this.identifier})},a.prototype.destroy=function(){this.$document.off("."+this.identifier),this.$window.off("."+this.identifier),this.$element.off("."+this.identifier).removeAttr("style").removeData("plugin_"+l),this.$range&&this.$range.length&&this.$range[0].parentNode.removeChild(this.$range[0])},t.fn[l]=function(i){var e=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=t(this),s=n.data("plugin_"+l);s||n.data("plugin_"+l,s=new a(this,i)),"string"==typeof i&&s[i].apply(s,e)})}});
var Core;!function(t){!function(t){!function(t){var e=function(){function t(t){var e=this;this.stepContents=t.find("[data-step]"),this.steps=t.find(".step"),this.currentStep=1,t.find(".mabel-btn-next-step").off("click").on("click",function(t){t.preventDefault(),e.next()}),t.find(".mabel-btn-prev-step").off("click").on("click",function(t){t.preventDefault(),e.prev()})}return t.prototype.toggleClasses=function(){this.stepContents.hide(),this.stepContents.eq(this.currentStep-1).show(),this.steps.removeClass("current done"),this.steps.eq(this.currentStep-1).addClass("current"),this.steps.eq(this.currentStep-1).prevAll().addClass("done")},t.prototype.setStep=function(t){this.currentStep=t,this.toggleClasses()},t.prototype.next=function(){this.currentStep++,this.toggleClasses()},t.prototype.prev=function(){this.currentStep--,this.toggleClasses()},t}();t.StepTracker=e}(t.Components||(t.Components={}))}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var Core;!function(t){!function(t){!function(t){var e=function(){function t(){}return t.getSlug=function(){return jQuery("[data-context]").data("slug")},t.getSettings=function(){var e=jQuery("#"+t.getSlug()+"-form").serializeArray(),n={};return e.forEach(function(e,r){var a=e.name.replace(t.getSettingsKey()+"[","").replace("]","");n[a]=e.value}),n},t.getSettingsKey=function(){return jQuery("[data-context]").data("settings-key")},t.getAdminAjaxUrl=function(){return jQuery("[data-context]").data("admin-ajax-url")},t}();t.Context=e}(t.Helpers||(t.Helpers={}))}(t.Admin||(t.Admin={}))}(Core||(Core={}));
var SIWCAdmin;!function(e){var t=Core.Admin.Components.MediaSelector,i=Core.Admin.Components.StepTracker,a=function(){function a(a){var r=this;this.home=a;this.clamped=!1,jQuery.views.settings.allowCode(!0),setInterval(function(){var e=a.find(".loader-indicator");e.html("•••"===e.html()?"":e.html()+"•")},155),jQuery.tips({action:"click",element:".tooltip"});var n=new i(a.find(".step-tracker-wrapper#add-image")),c=new e.Controllers.DrawBoard(a),o=new e.Controllers.Lister(a);new t(a.find(".btn-select-image"),function(e){r.activeImage=e.url,r.activeThumb=e.sizes&&e.sizes.thumbnail?e.sizes.thumbnail.url:e.url,a.find(".selected-img-holder img").attr("src",r.activeImage),c.setDrawBoard(),r.mode="create",n.next()});Core.Admin.Dispatcher.subscribe("image:edit",function(t){r.clamped&&r.unclamp();var i=[];a.find(".selected-img-holder img").attr("src",t.image),r.activeImage=t.id;var o=function(){r.mode="edit",c.setDrawBoard(),c.setTags(i),n.setStep(2),Core.Admin.Dispatcher.publish("tab:activate","options-addimage")},d=[];t.tags.forEach(function(e){d.push(e.id)});var s=[];e.Api.Product.getProductsByIds(d).then(function(e){s=e}).then(function(){t.tags.forEach(function(t){var a=new e.Models.Tag;if(a.percentageX=t.x,a.percentageY=t.y,a.product=new e.Models.Product(t.id,t.name,t.price),t.id){var r=e.Helpers.Collections.findBy(s,"id",t.id);r&&(a.product.name=r.name,a.product.price=r.price,a.product.url=r.url,i.push(a))}else i.push(a)}),o()})}),a.find(".btn-start-over").on("click",function(e){e.preventDefault(),c.setDrawBoard(),n.setStep(1),r.activeImage=null}),a.find(".btn-save-image").on("click",function(t){t.preventDefault();var i=jQuery(t.currentTarget);i.css("opacity","0.4"),i.prop("disabled",!0);var a=[];c.getTags().forEach(function(e){if(e.product){var t={x:e.percentageX,y:e.percentageY,id:e.product.id};e.product.id||(t.price=e.product.price,t.name=e.product.name,t.url=e.product.url),a.push(t)}});var d=function(e){o.displayImages(1),r.home.find(".active-shortcode").html('[shoppable_image id="'+e+'"]'),n.next(),i.css("opacity",1),i.prop("disabled",!1)};if("create"===r.mode){if(o.getTotalImgOnPage()>=3)return;e.Api.Images.addImage(r.activeImage,r.activeThumb,a).then(function(e){d(e)})}else e.Api.Images.updateImage(r.activeImage,a).then(function(){d(r.activeImage)})}),Core.Admin.Dispatcher.subscribe("settings:changed",function(e){c.draw(e)}),Core.Admin.Dispatcher.subscribe("tab:changed",function(e){"options-addimage"===e&&c.draw()}),Core.Admin.Dispatcher.subscribe("images:listed",function(){o.getTotalImgOnPage()>=3?r.clamp():r.unclamp()})}return a.prototype.unclamp=function(){jQuery(".step-tracker-wrapper").show(),jQuery(".upgrade-warning").hide(),this.clamped=!1},a.prototype.clamp=function(){jQuery(".step-tracker-wrapper").hide(),jQuery(".upgrade-warning").show(),this.clamped=!0},a}();e.Main=a}(SIWCAdmin||(SIWCAdmin={})),jQuery(document).ready(function(){new SIWCAdmin.Main(jQuery(document.body))});
var SIWCAdmin;!function(t){!function(e){var i=function(){function e(e){this.parent=e,this.wrapper=e.find(".selected-img-holder").first(),this.image=this.wrapper.find("img"),this.tags=[],this.popuptemplate=jQuery.templates("#popup-content-template"),this.initEvents();var i;this.autocompleteOptions={async:!0,display:function(t){return t.name},source:function(e,n,s){i&&clearTimeout(i),i=setTimeout(function(){jQuery(".loader-indicator").show(),t.Api.Product.getProductLikeName(e).then(function(t){return jQuery(".loader-indicator").hide(),s(t)})},300)}}}return e.prototype.getTags=function(){return this.tags},e.prototype.setTags=function(t){this.tags=t},e.prototype.setDrawBoard=function(){this.settings=Core.Admin.Helpers.Context.getSettings(),this.tags=[],this.clearElements(),this.initialized=!0},e.prototype.draw=function(i,n){var s=this;if(this.initialized){i&&(this.settings=i),this.clearElements(),this.settings.tagsize=parseInt(mabel_script_vars.tagsize),this.settings.iconsize=parseInt(mabel_script_vars.iconsize),this.settings.tagicon=mabel_script_vars.tagicon;jQuery(jQuery("#popup-content-template").html());this.tags.forEach(function(i,n){var a=jQuery('<i class="'+s.settings.tagicon+'">'),o=(jQuery('<span class="mb-siwc-tag"></span>').css({top:i.percentageY+"%",left:i.percentageX+"%",background:s.settings.tagbgcolor,color:s.settings.tagfgcolor,width:s.settings.tagsize+"px",height:s.settings.tagsize+"px",lineHeight:s.settings.tagsize+"px",fontSize:s.settings.iconsize+"px",borderRadius:s.settings.tagborderradius+"%",marginLeft:-s.settings.tagsize/2,marginTop:-s.settings.tagsize/2}).on("click",function(t){t.preventDefault(),t.stopPropagation();var e=jQuery(t.currentTarget),i=s.wrapper.find(".mb-siwc-tag");i.not(e).removeClass("active"),e.toggleClass("active"),i.not(e).next().addClass("mabel-invisible"),e.next().toggleClass("mabel-invisible")}).append(a).appendTo(s.wrapper),jQuery('<div class="mb-siwc-popup mabel-invisible">').appendTo(s.wrapper));o.on("click",".btn-delete-tag",function(t){t.preventDefault(),s.tags.splice(n,1),s.draw()}).on("click",".btn-change-product",function(t){t.preventDefault(),null==i.product.id?i.customProduct=!0:i.customProduct=!1,i.product=null,o.html(s.popuptemplate.render(i)),s.typeahead(i,o)}).on("click",".btn-change-to-custom",function(t){t.preventDefault(),i.product=null,i.customProduct=!0,o.html(s.popuptemplate.render(i))}).on("click",".btn-change-to-auto",function(t){t.preventDefault(),i.product=null,i.customProduct=!1,o.html(s.popuptemplate.render(i)),s.typeahead(i,o)}).on("click",".btn-save-custom ",function(e){e.preventDefault();var n=jQuery(e.currentTarget).closest(".popup-options"),a=n.find("[name=p-name]").val(),r=n.find("[name=p-link]").val();a&&r&&(i.product=new t.Models.Product(null,a,n.find("[name=p-price]").val()),i.product.url=r,o.html(s.popuptemplate.render(i)))}).css({top:i.percentageY+"%",left:i.percentageX+"%",marginLeft:-o.width()/2+"px",marginTop:s.settings.tagsize/2+15+"px"}),o.html(s.popuptemplate.render(i)),s.typeahead(i,o);var r=t.Helpers.PositionHelper.getPopupPosition(i,o,s.wrapper);if("bottom"!=r){e.boundingBoxSize,s.settings.tagsize;switch(r){case"top":o.css("marginTop",-1*(o.height()+15+s.settings.tagsize/2));break;case"top left":o.css({marginTop:-1*(o.height()-10),marginLeft:-1*(o.width()+15+s.settings.tagsize/2)});break;case"top right":o.css({marginTop:-1*(o.height()-10),marginLeft:s.settings.tagsize/2+15});break;case"bottom left":o.css({marginTop:-10,marginLeft:-1*(o.width()+15+s.settings.tagsize/2)});break;case"bottom right":o.css({marginTop:-10,marginLeft:s.settings.tagsize/2+15})}}o.addClass("mb-siwc-"+r.replace(" ","-"))}),n&&"function"==typeof n&&n()}},e.prototype.typeahead=function(e,i){var n=this;i.find(".mb-siwc-autocomplete").typeahead({hint:!0,highlight:!0,minLength:2},this.autocompleteOptions).on("typeahead:select",function(s,a){e.product=new t.Models.Product(a.id,a.name,a.price),i.html(n.popuptemplate.render(e))})},e.prototype.openActivePopup=function(){this.wrapper.find(".mb-siwc-tag").last().addClass("active"),this.wrapper.find(".mb-siwc-popup").last().removeClass("mabel-invisible")},e.prototype.initEvents=function(){var t=this;this.wrapper.find("img").on("click",function(e){var i=t.makeTag(e.pageX,e.pageY);t.tags.push(i),t.draw(null,function(){t.openActivePopup()})})},e.prototype.makeTag=function(e,i){var n=t.Helpers.PositionHelper.getMousePosition(this.wrapper,e,i),s=new t.Models.Tag(n.x,n.y),a=t.Helpers.PositionHelper.toPercentagePosition(this.wrapper,s.x,s.y);return s.percentageX=a.x,s.percentageY=a.y,s},e.prototype.clearElements=function(){this.wrapper.find("*").not("img").remove()},e.boundingBoxSize=80,e}();e.DrawBoard=i}(t.Controllers||(t.Controllers={}))}(SIWCAdmin||(SIWCAdmin={}));
var SIWCAdmin;!function(e){!function(t){var i=function(){function t(e){this.wrapper=e.find(".all-images-wrapper"),this.template=jQuery.templates("#image-template"),this.initPager(),this.initDeleteImage(),this.initEditImage(),this.displayImages(1)}return t.prototype.displayImages=function(t){var i=this;this.currentPage=t,this.wrapper.addClass("loading"),e.Api.Images.getImages(t).then(function(e){i.wrapper.html(i.template.render(e)),i.wrapper.removeClass("loading"),Core.Admin.Dispatcher.publish("images:listed")})},t.prototype.getTotalImgOnPage=function(){return this.wrapper.find(".image-tile").length},t.prototype.initPager=function(){var e=this;this.wrapper.on("click",".next",function(t){t.preventDefault(),e.displayImages(e.currentPage+1)}),this.wrapper.on("click",".prev",function(t){t.preventDefault(),e.displayImages(e.currentPage-1)})},t.prototype.initEditImage=function(){this.wrapper.on("click",".btn-edit-image",function(t){t.preventDefault();var i=jQuery(t.currentTarget);i.css("opacity","0.4"),i.prop("disabled",!0),e.Api.Images.getImage(jQuery(t.currentTarget).closest(".image-tile").data("id")).then(function(e){Core.Admin.Dispatcher.publish("image:edit",e),i.css("opacity","1"),i.prop("disabled",!1)})})},t.prototype.initDeleteImage=function(){this.wrapper.on("click",".btn-delete-image",function(t){t.preventDefault();var i=jQuery(t.currentTarget);if(confirm("Are you sure you'd like to delete this shoppable image?")){var r=jQuery(t.currentTarget).closest(".image-tile"),a=r.data("id");a&&(i.css("opacity","0.4"),e.Api.Images.deleteImage(a).then(function(){r.hide(0,function(){r.remove()})}))}})},t}();t.Lister=i}(e.Controllers||(e.Controllers={}))}(SIWCAdmin||(SIWCAdmin={}));
var SIWCAdmin;!function(e){!function(e){var t=function(){function e(){}return e.updateImage=function(t,n){return jQuery.post(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.update_image_action,id:t,tags:JSON.stringify(n)}).then(function(e){return e})},e.addImage=function(t,n,i){return jQuery.post(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.add_image_action,tags:JSON.stringify(i),image:t,thumb:n}).then(function(e){return e})},e.deleteImage=function(t){return jQuery.get(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.delete_image_action,imageId:t}).then(function(e){return e})},e.getImages=function(t){return jQuery.get(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.get_images_action,page:t}).then(function(e){return e})},e.getImage=function(t){return jQuery.get(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:e.get_image_action,id:t}).then(function(e){return e})},e.get_image_action="mb-siwc-get-image",e.get_images_action="mb-siwc-get-images",e.delete_image_action="mb-siwc-delete-image",e.add_image_action="mb-siwc-add-image",e.update_image_action="mb-siwc-update-image",e}();e.Images=t}(e.Api||(e.Api={}))}(SIWCAdmin||(SIWCAdmin={}));
var SIWCAdmin;!function(t){!function(t){var n=function(){function t(){}return t.getProductsByIds=function(n){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.get_by_ids_action,ids:n.join(",")}).then(function(t){return t})},t.getProductById=function(n){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.get_by_id_action,id:n}).then(function(t){return t})},t.getProductLikeName=function(n){return jQuery.getJSON(Core.Admin.Helpers.Context.getAdminAjaxUrl(),{action:t.get_like_name_action,q:n,dataType:"json"}).then(function(t){return t})},t.get_like_name_action="mb-siwc-get-products",t.get_by_id_action="mb-siwc-get-product-by-id",t.get_by_ids_action="mb-siwc-get-products-by-ids",t}();t.Product=n}(t.Api||(t.Api={}))}(SIWCAdmin||(SIWCAdmin={}));
var SIWCAdmin;!function(n){!function(n){var i=function(){function n(){}return n.findBy=function(n,i,r){if(!n||!n.length)return null;var t=null;return n.forEach(function(n,u){n[i]==r&&(t=n)}),t},n}();n.Collections=i}(n.Helpers||(n.Helpers={}))}(SIWCAdmin||(SIWCAdmin={}));
var SIWCAdmin;!function(t){!function(t){var n=function(){function t(){}return t.getPopupPosition=function(t,n,o){void 0===o&&(o=null),null==o&&(o=jQuery(document.body));var e=n.height(),i=n.width(),r=o.height(),u=o.width(),f=t.y+e>r,c=u-(u-t.x)<i/2,h=u-t.x<i/2,l=f?"top":"bottom";return c&&(l+=" right"),h&&(l+=" left"),l},t.getMousePosition=function(t,n,o){var e=t.offset();return{x:n-e.left,y:o-e.top}},t.getTopLeftPosition=function(t,n,o,e){var i=t.offset();return{x:n-i.left-e/2,y:o-i.top-e/2}},t.toPercentagePosition=function(t,n,o){return{x:n/t.width()*100,y:o/t.height()*100}},t}();t.PositionHelper=n}(t.Helpers||(t.Helpers={}))}(SIWCAdmin||(SIWCAdmin={}));
var SIWCAdmin;!function(n){!function(n){var i=function(){function n(n,i,d){void 0===i&&(i=null),void 0===d&&(d=null),this.name=i,this.id=n,this.price=d}return n}();n.Product=i}(n.Models||(n.Models={}))}(SIWCAdmin||(SIWCAdmin={}));
var SIWCAdmin;!function(n){!function(n){var i=function(){function n(n,i){this.x=n,this.y=i}return n}();n.Tag=i}(n.Models||(n.Models={}))}(SIWCAdmin||(SIWCAdmin={}));
!function(t,e){"function"==typeof define&&define.amd?define("bloodhound",["jquery"],function(n){return t.Bloodhound=e(n)}):"object"==typeof exports?module.exports=e(require("jquery")):t.Bloodhound=e(jQuery)}(this,function(t){var e=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return void 0===t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){if(!(i=n.call(null,r,t,e)))return!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){if(i=n.call(null,r,t,e))return!1}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var s,o,u=this,a=arguments;return s=function(){i=null,n||(r=t.apply(u,a))},o=n&&!i,clearTimeout(i),i=setTimeout(s,e),o&&(r=t.apply(u,a)),r}},throttle:function(t,e){var n,i,r,s,o,u;return o=0,u=function(){o=new Date,r=null,s=t.apply(n,i)},function(){var a=new Date,c=e-(a-o);return n=this,i=arguments,c<=0?(clearTimeout(r),r=null,o=a,s=t.apply(n,i)):r||(r=setTimeout(u,c)),s}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n="0.11.1",i=function(){"use strict";function t(t){return t=e.toStr(t),t?t.split(/\s+/):[]}function n(t){return t=e.toStr(t),t?t.split(/\W+/):[]}function i(t){return function(n){return n=e.isArray(n)?n:[].slice.call(arguments,0),function(i){var r=[];return e.each(n,function(n){r=r.concat(t(e.toStr(i[n])))}),r}}}return{nonword:n,whitespace:t,obj:{nonword:i(n),whitespace:i(t)}}}(),r=function(){"use strict";function n(n){this.maxSize=e.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function i(){this.head=this.tail=null}function r(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(n.prototype,{set:function(t,e){var n,i=this.list.tail;this.size>=this.maxSize&&(this.list.remove(i),delete this.hash[i.key],this.size--),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new r(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];if(e)return this.list.moveToFront(e),e.val},reset:function(){this.size=0,this.hash={},this.list=new i}}),e.mixin(i.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),n}(),s=function(){"use strict";function n(t,n){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix)),this.ls=n||u,!this.ls&&this._noop()}function i(){return(new Date).getTime()}function r(t){return JSON.stringify(e.isUndefined(t)?null:t)}function s(e){return t.parseJSON(e)}function o(t){var e,n,i=[],r=u.length;for(e=0;e<r;e++)(n=u.key(e)).match(t)&&i.push(n.replace(t,""));return i}var u;try{u=window.localStorage,u.setItem("~~~","!"),u.removeItem("~~~")}catch(t){u=null}return e.mixin(n.prototype,{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},_noop:function(){this.get=this.set=this.remove=this.clear=this.isExpired=e.noop},_safeSet:function(t,e){try{this.ls.setItem(t,e)}catch(t){"QuotaExceededError"===t.name&&(this.clear(),this._noop())}},get:function(t){return this.isExpired(t)&&this.remove(t),s(this.ls.getItem(this._prefix(t)))},set:function(t,n,s){return e.isNumber(s)?this._safeSet(this._ttlKey(t),r(i()+s)):this.ls.removeItem(this._ttlKey(t)),this._safeSet(this._prefix(t),r(n))},remove:function(t){return this.ls.removeItem(this._ttlKey(t)),this.ls.removeItem(this._prefix(t)),this},clear:function(){var t,e=o(this.keyMatcher);for(t=e.length;t--;)this.remove(e[t]);return this},isExpired:function(t){var n=s(this.ls.getItem(this._ttlKey(t)));return!!(e.isNumber(n)&&i()>n)}}),n}(),o=function(){"use strict";function n(t){t=t||{},this.cancelled=!1,this.lastReq=null,this._send=t.transport,this._get=t.limiter?t.limiter(this._get):this._get,this._cache=!1===t.cache?new r(0):u}var i=0,s={},o=6,u=new r(10);return n.setMaxPendingRequests=function(t){o=t},n.resetCache=function(){u.reset()},e.mixin(n.prototype,{_fingerprint:function(e){return e=e||{},e.url+e.type+t.param(e.data||{})},_get:function(t,e){function n(t){e(null,t),h._cache.set(a,t)}function r(){e(!0)}function u(){i--,delete s[a],h.onDeckRequestArgs&&(h._get.apply(h,h.onDeckRequestArgs),h.onDeckRequestArgs=null)}var a,c,h=this;a=this._fingerprint(t),this.cancelled||a!==this.lastReq||((c=s[a])?c.done(n).fail(r):i<o?(i++,s[a]=this._send(t).done(n).fail(r).always(u)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(n,i){var r,s;i=i||t.noop,n=e.isString(n)?{url:n}:n||{},s=this._fingerprint(n),this.cancelled=!1,this.lastReq=s,(r=this._cache.get(s))?i(null,r):this._get(n,i)},cancel:function(){this.cancelled=!0}}),n}(),u=window.SearchIndex=function(){"use strict";function n(n){n=n||{},n.datumTokenizer&&n.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.identify=n.identify||e.stringify,this.datumTokenizer=n.datumTokenizer,this.queryTokenizer=n.queryTokenizer,this.reset()}function i(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function r(){var t={};return t[a]=[],t[u]={},t}function s(t){for(var e={},n=[],i=0,r=t.length;i<r;i++)e[t[i]]||(e[t[i]]=!0,n.push(t[i]));return n}function o(t,e){var n=0,i=0,r=[];t=t.sort(),e=e.sort();for(var s=t.length,o=e.length;n<s&&i<o;)t[n]<e[i]?n++:t[n]>e[i]?i++:(r.push(t[n]),n++,i++);return r}var u="c",a="i";return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var s,o;n.datums[s=n.identify(t)]=t,o=i(n.datumTokenizer(t)),e.each(o,function(t){var e,i,o;for(e=n.trie,i=t.split("");o=i.shift();)e=e[u][o]||(e[u][o]=r()),e[a].push(s)})})},get:function(t){var n=this;return e.map(t,function(t){return n.datums[t]})},search:function(t){var n,r,c=this;return n=i(this.queryTokenizer(t)),e.each(n,function(t){var e,n,i,s;if(r&&0===r.length)return!1;for(e=c.trie,n=t.split("");e&&(i=n.shift());)e=e[u][i];if(!e||0!==n.length)return r=[],!1;s=e[a].slice(0),r=r?o(r,s):s}),r?e.map(s(r),function(t){return c.datums[t]}):[]},all:function(){var t=[];for(var e in this.datums)t.push(this.datums[e]);return t},reset:function(){this.datums={},this.trie=r()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),a=function(){"use strict";function t(t){this.url=t.url,this.ttl=t.ttl,this.cache=t.cache,this.prepare=t.prepare,this.transform=t.transform,this.transport=t.transport,this.thumbprint=t.thumbprint,this.storage=new s(t.cacheKey)}var n;return n={data:"data",protocol:"protocol",thumbprint:"thumbprint"},e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},store:function(t){this.cache&&(this.storage.set(n.data,t,this.ttl),this.storage.set(n.protocol,location.protocol,this.ttl),this.storage.set(n.thumbprint,this.thumbprint,this.ttl))},fromCache:function(){var t,e={};return this.cache?(e.data=this.storage.get(n.data),e.protocol=this.storage.get(n.protocol),e.thumbprint=this.storage.get(n.thumbprint),t=e.thumbprint!==this.thumbprint||e.protocol!==location.protocol,e.data&&!t?e.data:null):null},fromNetwork:function(t){function e(){t(!0)}function n(e){t(null,r.transform(e))}var i,r=this;t&&(i=this.prepare(this._settings()),this.transport(i).fail(e).done(n))},clear:function(){return this.storage.clear(),this}}),t}(),c=function(){"use strict";function t(t){this.url=t.url,this.prepare=t.prepare,this.transform=t.transform,this.transport=new o({cache:t.cache,limiter:t.limiter,transport:t.transport})}return e.mixin(t.prototype,{_settings:function(){return{url:this.url,type:"GET",dataType:"json"}},get:function(t,e){function n(t,n){e(t?[]:r.transform(n))}var i,r=this;if(e)return t=t||"",i=this.prepare(t,this._settings()),this.transport.get(i,n)},cancelLastRequest:function(){this.transport.cancel()}}),t}(),h=function(){"use strict";function i(i){var r;return i?(r={url:null,ttl:864e5,cache:!0,cacheKey:null,thumbprint:"",prepare:e.identity,transform:e.identity,transport:null},i=e.isString(i)?{url:i}:i,i=e.mixin(r,i),!i.url&&t.error("prefetch requires url to be set"),i.transform=i.filter||i.transform,i.cacheKey=i.cacheKey||i.url,i.thumbprint=n+i.thumbprint,i.transport=i.transport?u(i.transport):t.ajax,i):null}function r(n){var i;if(n)return i={url:null,cache:!0,prepare:null,replace:null,wildcard:null,limiter:null,rateLimitBy:"debounce",rateLimitWait:300,transform:e.identity,transport:null},n=e.isString(n)?{url:n}:n,n=e.mixin(i,n),!n.url&&t.error("remote requires url to be set"),n.transform=n.filter||n.transform,n.prepare=s(n),n.limiter=o(n),n.transport=n.transport?u(n.transport):t.ajax,delete n.replace,delete n.wildcard,delete n.rateLimitBy,delete n.rateLimitWait,n}function s(t){function e(t,e){return e.url=s(e.url,t),e}function n(t,e){return e.url=e.url.replace(o,encodeURIComponent(t)),e}function i(t,e){return e}var r,s,o;return r=t.prepare,s=t.replace,o=t.wildcard,r||(r=s?e:t.wildcard?n:i)}function o(t){var n,i,r;return n=t.limiter,i=t.rateLimitBy,r=t.rateLimitWait,n||(n=/^throttle$/i.test(i)?function(t){return function(n){return e.throttle(n,t)}}(r):function(t){return function(n){return e.debounce(n,t)}}(r)),n}function u(n){return function(i){function r(t){e.defer(function(){o.resolve(t)})}function s(t){e.defer(function(){o.reject(t)})}var o=t.Deferred();return n(i,r,s),o}}return function(n){var s,o;return s={initialize:!0,identify:e.stringify,datumTokenizer:null,queryTokenizer:null,sufficient:5,sorter:null,local:[],prefetch:null,remote:null},n=e.mixin(s,n||{}),!n.datumTokenizer&&t.error("datumTokenizer is required"),!n.queryTokenizer&&t.error("queryTokenizer is required"),o=n.sorter,n.sorter=o?function(t){return t.sort(o)}:e.identity,n.local=e.isFunction(n.local)?n.local():n.local,n.prefetch=i(n.prefetch),n.remote=r(n.remote),n}}();return function(){"use strict";function n(t){t=h(t),this.sorter=t.sorter,this.identify=t.identify,this.sufficient=t.sufficient,this.local=t.local,this.remote=t.remote?new c(t.remote):null,this.prefetch=t.prefetch?new a(t.prefetch):null,this.index=new u({identify:this.identify,datumTokenizer:t.datumTokenizer,queryTokenizer:t.queryTokenizer}),!1!==t.initialize&&this.initialize()}var r;return r=window&&window.Bloodhound,n.noConflict=function(){return window&&(window.Bloodhound=r),n},n.tokenizers=i,e.mixin(n.prototype,{__ttAdapter:function(){function t(t,e,i){return n.search(t,e,i)}function e(t,e){return n.search(t,e)}var n=this;return this.remote?t:e},_loadPrefetch:function(){function e(t,e){if(t)return n.reject();r.add(e),r.prefetch.store(r.index.serialize()),n.resolve()}var n,i,r=this;return n=t.Deferred(),this.prefetch?(i=this.prefetch.fromCache())?(this.index.bootstrap(i),n.resolve()):this.prefetch.fromNetwork(e):n.resolve(),n.promise()},_initialize:function(){function t(){e.add(e.local)}var e=this;return this.clear(),(this.initPromise=this._loadPrefetch()).done(t),this.initPromise},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){return this.index.add(t),this},get:function(t){return t=e.isArray(t)?t:[].slice.call(arguments),this.index.get(t)},search:function(t,n,i){function r(t){var n=[];e.each(t,function(t){!e.some(s,function(e){return o.identify(t)===o.identify(e)})&&n.push(t)}),i&&i(n)}var s,o=this;return s=this.sorter(this.index.search(t)),n(this.remote?s.slice():s),this.remote&&s.length<this.sufficient?this.remote.get(t,r):this.remote&&this.remote.cancelLastRequest(),this},all:function(){return this.index.all()},clear:function(){return this.index.reset(),this},clearPrefetchCache:function(){return this.prefetch&&this.prefetch.clear(),this},clearRemoteCache:function(){return o.resetCache(),this},ttAdapter:function(){return this.__ttAdapter()}}),n}()}),function(t,e){"function"==typeof define&&define.amd?define("typeahead.js",["jquery"],function(t){return e(t)}):"object"==typeof exports?module.exports=e(require("jquery")):e(jQuery)}(0,function(t){var e=function(){"use strict";return{isMsie:function(){return!!/(msie|trident)/i.test(navigator.userAgent)&&navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return void 0===t},isElement:function(t){return!(!t||1!==t.nodeType)},isJQuery:function(e){return e instanceof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function i(t,e){return n(e,t)}t.each(e,i)},map:t.map,filter:t.grep,every:function(e,n){var i=!0;return e?(t.each(e,function(t,r){if(!(i=n.call(null,r,t,e)))return!1}),!!i):i},some:function(e,n){var i=!1;return e?(t.each(e,function(t,r){if(i=n.call(null,r,t,e))return!1}),!!i):i},mixin:t.extend,identity:function(t){return t},clone:function(e){return t.extend(!0,{},e)},getIdGenerator:function(){var t=0;return function(){return t++}},templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var i,r;return function(){var s,o,u=this,a=arguments;return s=function(){i=null,n||(r=t.apply(u,a))},o=n&&!i,clearTimeout(i),i=setTimeout(s,e),o&&(r=t.apply(u,a)),r}},throttle:function(t,e){var n,i,r,s,o,u;return o=0,u=function(){o=new Date,r=null,s=t.apply(n,i)},function(){var a=new Date,c=e-(a-o);return n=this,i=arguments,c<=0?(clearTimeout(r),r=null,o=a,s=t.apply(n,i)):r||(r=setTimeout(u,c)),s}},stringify:function(t){return e.isString(t)?t:JSON.stringify(t)},noop:function(){}}}(),n=function(){"use strict";function t(t){var o,u;return u=e.mixin({},s,t),o={css:r(),classes:u,html:n(u),selectors:i(u)},{css:o.css,html:o.html,classes:o.classes,selectors:o.selectors,mixin:function(t){e.mixin(t,o)}}}function n(t){return{wrapper:'<span class="'+t.wrapper+'"></span>',menu:'<div class="'+t.menu+'"></div>'}}function i(t){var n={};return e.each(t,function(t,e){n[e]="."+t}),n}function r(){var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},menu:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),t}var s={wrapper:"twitter-typeahead",input:"tt-input",hint:"tt-hint",menu:"tt-menu",dataset:"tt-dataset",suggestion:"tt-suggestion",selectable:"tt-selectable",empty:"tt-empty",open:"tt-open",cursor:"tt-cursor",highlight:"tt-highlight"};return t}(),i=function(){"use strict";function n(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var i,r;return i="typeahead:",r={render:"rendered",cursorchange:"cursorchanged",select:"selected",autocomplete:"autocompleted"},e.mixin(n.prototype,{_trigger:function(e,n){var r;return r=t.Event(i+e),(n=n||[]).unshift(r),this.$el.trigger.apply(this.$el,n),r},before:function(t){var e,n;return e=[].slice.call(arguments,1),n=this._trigger("before"+t,e),n.isDefaultPrevented()},trigger:function(t){var e;this._trigger(t,[].slice.call(arguments,1)),(e=r[t])&&this._trigger(e,[].slice.call(arguments,1))}}),n}(),r=function(){"use strict";function t(t,e,n,i){var r;if(!n)return this;for(e=e.split(u),n=i?o(n,i):n,this._callbacks=this._callbacks||{};r=e.shift();)this._callbacks[r]=this._callbacks[r]||{sync:[],async:[]},this._callbacks[r][t].push(n);return this}function e(e,n,i){return t.call(this,"async",e,n,i)}function n(e,n,i){return t.call(this,"sync",e,n,i)}function i(t){var e;if(!this._callbacks)return this;for(t=t.split(u);e=t.shift();)delete this._callbacks[e];return this}function r(t){var e,n,i,r,o;if(!this._callbacks)return this;for(t=t.split(u),i=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)r=s(n.sync,this,[e].concat(i)),o=s(n.async,this,[e].concat(i)),r()&&a(o);return this}function s(t,e,n){function i(){for(var i,r=0,s=t.length;!i&&r<s;r+=1)i=!1===t[r].apply(e,n);return!i}return i}function o(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}var u=/\s+/,a=function(){return window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)}}();return{onSync:n,onAsync:e,off:i,trigger:r}}(),s=function(t){"use strict";function n(t,n,i){for(var r,s=[],o=0,u=t.length;o<u;o++)s.push(e.escapeRegExChars(t[o]));return r=i?"\\b("+s.join("|")+")\\b":"("+s.join("|")+")",n?new RegExp(r):new RegExp(r,"i")}var i={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(r){function s(e){var n,i,s;return(n=u.exec(e.data))&&(s=t.createElement(r.tagName),r.className&&(s.className=r.className),i=e.splitText(n.index),i.splitText(n[0].length),s.appendChild(i.cloneNode(!0)),e.parentNode.replaceChild(s,i)),!!n}function o(t,e){for(var n,i=0;i<t.childNodes.length;i++)n=t.childNodes[i],3===n.nodeType?i+=e(n)?1:0:o(n,e)}var u;r=e.mixin({},i,r),r.node&&r.pattern&&(r.pattern=e.isArray(r.pattern)?r.pattern:[r.pattern],u=n(r.pattern,r.caseSensitive,r.wordsOnly),o(r.node,s))}}(window.document),o=function(){"use strict";function n(n,r){n=n||{},n.input||t.error("input is missing"),r.mixin(this),this.$hint=t(n.hint),this.$input=t(n.input),this.query=this.$input.val(),this.queryWhenFocused=this.hasFocus()?this.query:null,this.$overflowHelper=i(this.$input),this._checkLanguageDirection(),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop)}function i(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function s(t,e){return n.normalizeQuery(t)===n.normalizeQuery(e)}function o(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var u;return u={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return e.toStr(t).replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,r,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.queryWhenFocused=this.query,this.trigger("focused")},_onKeydown:function(t){var e=u[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._setQuery(this.getInputValue()),this.clearHintIfInvalid(),this._checkLanguageDirection()},_managePreventDefault:function(t,e){var n;switch(t){case"up":case"down":n=!o(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!o(e);break;default:n=!0}return n},_checkLanguageDirection:function(){var t=(this.$input.css("direction")||"ltr").toLowerCase();this.dir!==t&&(this.dir=t,this.$hint.attr("dir",t),this.trigger("langDirChanged",t))},_setQuery:function(t,e){var n,i;n=s(t,this.query),i=!!n&&this.query.length!==t.length,this.query=t,e||n?!e&&i&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},bind:function(){var t,n,i,r,s=this;return t=e.bind(this._onBlur,this),n=e.bind(this._onFocus,this),i=e.bind(this._onKeydown,this),r=e.bind(this._onInput,this),this.$input.on("blur.tt",t).on("focus.tt",n).on("keydown.tt",i),!e.isMsie()||e.isMsie()>9?this.$input.on("input.tt",r):this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){u[t.which||t.keyCode]||e.defer(e.bind(s._onInput,s,t))}),this},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getLangDir:function(){return this.dir},getQuery:function(){return this.query||""},setQuery:function(t,e){this.setInputValue(t),this._setQuery(t,e)},hasQueryChangedSinceLastFocus:function(){return this.query!==this.queryWhenFocused},getInputValue:function(){return this.$input.val()},setInputValue:function(t){this.$input.val(t),this.clearHintIfInvalid(),this._checkLanguageDirection()},resetInputValue:function(){this.setInputValue(this.query)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n,i;t=this.getInputValue(),e=this.getHint(),n=t!==e&&0===e.indexOf(t),!(i=""!==t&&n&&!this.hasOverflow())&&this.clearHint()},hasFocus:function(){return this.$input.is(":focus")},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,n,i;return t=this.$input.val().length,n=this.$input[0].selectionStart,e.isNumber(n)?n===t:!document.selection||(i=document.selection.createRange(),i.moveStart("character",-t),t===i.text.length)},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$overflowHelper.remove(),this.$hint=this.$input=this.$overflowHelper=t("<div>")}}),n}(),u=function(){"use strict";function n(n,r){n=n||{},n.templates=n.templates||{},n.templates.notFound=n.templates.notFound||n.templates.empty,n.source||t.error("missing source"),n.node||t.error("missing node"),n.name&&!u(n.name)&&t.error("invalid dataset name: "+n.name),r.mixin(this),this.highlight=!!n.highlight,this.name=n.name||c(),this.limit=n.limit||5,this.displayFn=i(n.display||n.displayKey),this.templates=o(n.templates,this.displayFn),this.source=n.source.__ttAdapter?n.source.__ttAdapter():n.source,this.async=e.isUndefined(n.async)?this.source.length>2:!!n.async,this._resetLastSuggestion(),this.$el=t(n.node).addClass(this.classes.dataset).addClass(this.classes.dataset+"-"+this.name)}function i(t){function n(e){return e[t]}return t=t||e.stringify,e.isFunction(t)?t:n}function o(n,i){function r(e){return t("<div>").text(i(e))}return{notFound:n.notFound&&e.templatify(n.notFound),pending:n.pending&&e.templatify(n.pending),header:n.header&&e.templatify(n.header),footer:n.footer&&e.templatify(n.footer),suggestion:n.suggestion||r}}function u(t){return/^[_a-zA-Z0-9-]+$/.test(t)}var a,c;return a={val:"tt-selectable-display",obj:"tt-selectable-object"},c=e.getIdGenerator(),n.extractData=function(e){var n=t(e);return n.data(a.obj)?{val:n.data(a.val)||"",obj:n.data(a.obj)||null}:null},e.mixin(n.prototype,r,{_overwrite:function(t,e){e=e||[],e.length?this._renderSuggestions(t,e):this.async&&this.templates.pending?this._renderPending(t):!this.async&&this.templates.notFound?this._renderNotFound(t):this._empty(),this.trigger("rendered",this.name,e,!1)},_append:function(t,e){e=e||[],e.length&&this.$lastSuggestion.length?this._appendSuggestions(t,e):e.length?this._renderSuggestions(t,e):!this.$lastSuggestion.length&&this.templates.notFound&&this._renderNotFound(t),this.trigger("rendered",this.name,e,!0)},_renderSuggestions:function(t,e){var n;n=this._getSuggestionsFragment(t,e),this.$lastSuggestion=n.children().last(),this.$el.html(n).prepend(this._getHeader(t,e)).append(this._getFooter(t,e))},_appendSuggestions:function(t,e){var n,i;n=this._getSuggestionsFragment(t,e),i=n.children().last(),this.$lastSuggestion.after(n),this.$lastSuggestion=i},_renderPending:function(t){var e=this.templates.pending;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_renderNotFound:function(t){var e=this.templates.notFound;this._resetLastSuggestion(),e&&this.$el.html(e({query:t,dataset:this.name}))},_empty:function(){this.$el.empty(),this._resetLastSuggestion()},_getSuggestionsFragment:function(n,i){var r,o=this;return r=document.createDocumentFragment(),e.each(i,function(e){var i,s;s=o._injectQuery(n,e),i=t(o.templates.suggestion(s)).data(a.obj,e).data(a.val,o.displayFn(e)).addClass(o.classes.suggestion+" "+o.classes.selectable),r.appendChild(i[0])}),this.highlight&&s({className:this.classes.highlight,node:r,pattern:n}),t(r)},_getFooter:function(t,e){return this.templates.footer?this.templates.footer({query:t,suggestions:e,dataset:this.name}):null},_getHeader:function(t,e){return this.templates.header?this.templates.header({query:t,suggestions:e,dataset:this.name}):null},_resetLastSuggestion:function(){this.$lastSuggestion=t()},_injectQuery:function(t,n){return e.isObject(n)?e.mixin({_query:t},n):n},update:function(e){function n(t){o||(o=!0,t=(t||[]).slice(0,r.limit),u=t.length,r._overwrite(e,t),u<r.limit&&r.async&&r.trigger("asyncRequested",e))}function i(n){n=n||[],!s&&u<r.limit&&(r.cancel=t.noop,n=n.slice(0,r.limit-u),u+=n.length,r._append(e,n),r.async&&r.trigger("asyncReceived",e))}var r=this,s=!1,o=!1,u=0;this.cancel(),this.cancel=function(){s=!0,r.cancel=t.noop,r.async&&r.trigger("asyncCanceled",e)},this.source(e,n,i),!o&&n([])},cancel:t.noop,clear:function(){this._empty(),this.cancel(),this.trigger("cleared")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=t("<div>")}}),n}(),a=function(){"use strict";function n(n,i){function r(e){var n=s.$node.find(e.node).first();return e.node=n.length?n:t("<div>").appendTo(s.$node),new u(e,i)}var s=this;n=n||{},n.node||t.error("node is required"),i.mixin(this),this.$node=t(n.node),this.query=null,this.datasets=e.map(n.datasets,r)}return e.mixin(n.prototype,r,{_onSelectableClick:function(e){this.trigger("selectableClicked",t(e.currentTarget))},_onRendered:function(t,e,n,i){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetRendered",e,n,i)},_onCleared:function(){this.$node.toggleClass(this.classes.empty,this._allDatasetsEmpty()),this.trigger("datasetCleared")},_propagate:function(){this.trigger.apply(this,arguments)},_allDatasetsEmpty:function(){function t(t){return t.isEmpty()}return e.every(this.datasets,t)},_getSelectables:function(){return this.$node.find(this.selectors.selectable)},_removeCursor:function(){var t=this.getActiveSelectable();t&&t.removeClass(this.classes.cursor)},_ensureVisible:function(t){var e,n,i,r;e=t.position().top,n=e+t.outerHeight(!0),i=this.$node.scrollTop(),r=this.$node.height()+parseInt(this.$node.css("paddingTop"),10)+parseInt(this.$node.css("paddingBottom"),10),e<0?this.$node.scrollTop(i+e):r<n&&this.$node.scrollTop(i+(n-r))},bind:function(){var t,n=this;return t=e.bind(this._onSelectableClick,this),this.$node.on("click.tt",this.selectors.selectable,t),e.each(this.datasets,function(t){t.onSync("asyncRequested",n._propagate,n).onSync("asyncCanceled",n._propagate,n).onSync("asyncReceived",n._propagate,n).onSync("rendered",n._onRendered,n).onSync("cleared",n._onCleared,n)}),this},isOpen:function(){return this.$node.hasClass(this.classes.open)},open:function(){this.$node.addClass(this.classes.open)},close:function(){this.$node.removeClass(this.classes.open),this._removeCursor()},setLanguageDirection:function(t){this.$node.attr("dir",t)},selectableRelativeToCursor:function(t){var e,n,i,r;return n=this.getActiveSelectable(),e=this._getSelectables(),i=n?e.index(n):-1,r=i+t,r=(r+1)%(e.length+1)-1,r=r<-1?e.length-1:r,-1===r?null:e.eq(r)},setCursor:function(t){this._removeCursor(),(t=t&&t.first())&&(t.addClass(this.classes.cursor),this._ensureVisible(t))},getSelectableData:function(t){return t&&t.length?u.extractData(t):null},getActiveSelectable:function(){var t=this._getSelectables().filter(this.selectors.cursor).first();return t.length?t:null},getTopSelectable:function(){var t=this._getSelectables().first();return t.length?t:null},update:function(t){function n(e){e.update(t)}var i=t!==this.query;return i&&(this.query=t,e.each(this.datasets,n)),i},empty:function(){function t(t){t.clear()}e.each(this.datasets,t),this.query=null,this.$node.addClass(this.classes.empty)},destroy:function(){function n(t){t.destroy()}this.$node.off(".tt"),this.$node=t("<div>"),e.each(this.datasets,n)}}),n}(),c=function(){"use strict";function t(){a.apply(this,[].slice.call(arguments,0))}var n=a.prototype;return e.mixin(t.prototype,a.prototype,{open:function(){return!this._allDatasetsEmpty()&&this._show(),n.open.apply(this,[].slice.call(arguments,0))},close:function(){return this._hide(),n.close.apply(this,[].slice.call(arguments,0))},_onRendered:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onRendered.apply(this,[].slice.call(arguments,0))},_onCleared:function(){return this._allDatasetsEmpty()?this._hide():this.isOpen()&&this._show(),n._onCleared.apply(this,[].slice.call(arguments,0))},setLanguageDirection:function(t){return this.$node.css("ltr"===t?this.css.ltr:this.css.rtl),n.setLanguageDirection.apply(this,[].slice.call(arguments,0))},_hide:function(){this.$node.hide()},_show:function(){this.$node.css("display","block")}}),t}(),h=function(){"use strict";function n(n,r){var s,o,u,a,c,h,l,f,d,p,g;n=n||{},n.input||t.error("missing input"),n.menu||t.error("missing menu"),n.eventBus||t.error("missing event bus"),r.mixin(this),this.eventBus=n.eventBus,this.minLength=e.isNumber(n.minLength)?n.minLength:1,this.input=n.input,this.menu=n.menu,this.enabled=!0,this.active=!1,this.input.hasFocus()&&this.activate(),this.dir=this.input.getLangDir(),this._hacks(),this.menu.bind().onSync("selectableClicked",this._onSelectableClicked,this).onSync("asyncRequested",this._onAsyncRequested,this).onSync("asyncCanceled",this._onAsyncCanceled,this).onSync("asyncReceived",this._onAsyncReceived,this).onSync("datasetRendered",this._onDatasetRendered,this).onSync("datasetCleared",this._onDatasetCleared,this),s=i(this,"activate","open","_onFocused"),o=i(this,"deactivate","_onBlurred"),u=i(this,"isActive","isOpen","_onEnterKeyed"),a=i(this,"isActive","isOpen","_onTabKeyed"),c=i(this,"isActive","_onEscKeyed"),h=i(this,"isActive","open","_onUpKeyed"),l=i(this,"isActive","open","_onDownKeyed"),f=i(this,"isActive","isOpen","_onLeftKeyed"),d=i(this,"isActive","isOpen","_onRightKeyed"),p=i(this,"_openIfActive","_onQueryChanged"),g=i(this,"_openIfActive","_onWhitespaceChanged"),this.input.bind().onSync("focused",s,this).onSync("blurred",o,this).onSync("enterKeyed",u,this).onSync("tabKeyed",a,this).onSync("escKeyed",c,this).onSync("upKeyed",h,this).onSync("downKeyed",l,this).onSync("leftKeyed",f,this).onSync("rightKeyed",d,this).onSync("queryChanged",p,this).onSync("whitespaceChanged",g,this).onSync("langDirChanged",this._onLangDirChanged,this)}function i(t){var n=[].slice.call(arguments,1);return function(){var i=[].slice.call(arguments);e.each(n,function(e){return t[e].apply(t,i)})}}return e.mixin(n.prototype,{_hacks:function(){var n,i;n=this.input.$input||t("<div>"),i=this.menu.$node||t("<div>"),
n.on("blur.tt",function(t){var r,s,o;r=document.activeElement,s=i.is(r),o=i.has(r).length>0,e.isMsie()&&(s||o)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer(function(){n.focus()}))}),i.on("mousedown.tt",function(t){t.preventDefault()})},_onSelectableClicked:function(t,e){this.select(e)},_onDatasetCleared:function(){this._updateHint()},_onDatasetRendered:function(t,e,n,i){this._updateHint(),this.eventBus.trigger("render",n,i,e)},_onAsyncRequested:function(t,e,n){this.eventBus.trigger("asyncrequest",n,e)},_onAsyncCanceled:function(t,e,n){this.eventBus.trigger("asynccancel",n,e)},_onAsyncReceived:function(t,e,n){this.eventBus.trigger("asyncreceive",n,e)},_onFocused:function(){this._minLengthMet()&&this.menu.update(this.input.getQuery())},_onBlurred:function(){this.input.hasQueryChangedSinceLastFocus()&&this.eventBus.trigger("change",this.input.getQuery())},_onEnterKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())&&this.select(n)&&e.preventDefault()},_onTabKeyed:function(t,e){var n;(n=this.menu.getActiveSelectable())?this.select(n)&&e.preventDefault():(n=this.menu.getTopSelectable())&&this.autocomplete(n)&&e.preventDefault()},_onEscKeyed:function(){this.close()},_onUpKeyed:function(){this.moveCursor(-1)},_onDownKeyed:function(){this.moveCursor(1)},_onLeftKeyed:function(){"rtl"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onRightKeyed:function(){"ltr"===this.dir&&this.input.isCursorAtEnd()&&this.autocomplete(this.menu.getTopSelectable())},_onQueryChanged:function(t,e){this._minLengthMet(e)?this.menu.update(e):this.menu.empty()},_onWhitespaceChanged:function(){this._updateHint()},_onLangDirChanged:function(t,e){this.dir!==e&&(this.dir=e,this.menu.setLanguageDirection(e))},_openIfActive:function(){this.isActive()&&this.open()},_minLengthMet:function(t){return t=e.isString(t)?t:this.input.getQuery()||"",t.length>=this.minLength},_updateHint:function(){var t,n,i,r,s,u,a;t=this.menu.getTopSelectable(),n=this.menu.getSelectableData(t),i=this.input.getInputValue(),!n||e.isBlankString(i)||this.input.hasOverflow()?this.input.clearHint():(r=o.normalizeQuery(i),s=e.escapeRegExChars(r),u=new RegExp("^(?:"+s+")(.+$)","i"),(a=u.exec(n.val))&&this.input.setHint(i+a[1]))},isEnabled:function(){return this.enabled},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},isActive:function(){return this.active},activate:function(){return!!this.isActive()||!(!this.isEnabled()||this.eventBus.before("active"))&&(this.active=!0,this.eventBus.trigger("active"),!0)},deactivate:function(){return!this.isActive()||!this.eventBus.before("idle")&&(this.active=!1,this.close(),this.eventBus.trigger("idle"),!0)},isOpen:function(){return this.menu.isOpen()},open:function(){return this.isOpen()||this.eventBus.before("open")||(this.menu.open(),this._updateHint(),this.eventBus.trigger("open")),this.isOpen()},close:function(){return this.isOpen()&&!this.eventBus.before("close")&&(this.menu.close(),this.input.clearHint(),this.input.resetInputValue(),this.eventBus.trigger("close")),!this.isOpen()},setVal:function(t){this.input.setQuery(e.toStr(t))},getVal:function(){return this.input.getQuery()},select:function(t){var e=this.menu.getSelectableData(t);return!(!e||this.eventBus.before("select",e.obj))&&(this.input.setQuery(e.val,!0),this.eventBus.trigger("select",e.obj),this.close(),!0)},autocomplete:function(t){var e,n;return e=this.input.getQuery(),n=this.menu.getSelectableData(t),!(!(n&&e!==n.val)||this.eventBus.before("autocomplete",n.obj))&&(this.input.setQuery(n.val),this.eventBus.trigger("autocomplete",n.obj),!0)},moveCursor:function(t){var e,n,i,r;return e=this.input.getQuery(),n=this.menu.selectableRelativeToCursor(t),i=this.menu.getSelectableData(n),r=i?i.obj:null,!(this._minLengthMet()&&this.menu.update(e))&&!this.eventBus.before("cursorchange",r)&&(this.menu.setCursor(n),i?this.input.setInputValue(i.val):(this.input.resetInputValue(),this._updateHint()),this.eventBus.trigger("cursorchange",r),!0)},destroy:function(){this.input.destroy(),this.menu.destroy()}}),n}();!function(){"use strict";function r(e,n){e.each(function(){var e,i=t(this);(e=i.data(g.typeahead))&&n(e,i)})}function s(t,e){return t.clone().addClass(e.classes.hint).removeData().css(e.css.hint).css(l(t)).prop("readonly",!0).removeAttr("id name placeholder required").attr({autocomplete:"off",spellcheck:"false",tabindex:-1})}function u(t,e){t.data(g.attrs,{dir:t.attr("dir"),autocomplete:t.attr("autocomplete"),spellcheck:t.attr("spellcheck"),style:t.attr("style")}),t.addClass(e.classes.input).attr({autocomplete:"off",spellcheck:!1});try{!t.attr("dir")&&t.attr("dir","auto")}catch(t){}return t}function l(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function f(t){var n,i;n=t.data(g.www),i=t.parent().filter(n.selectors.wrapper),e.each(t.data(g.attrs),function(n,i){e.isUndefined(n)?t.removeAttr(i):t.attr(i,n)}),t.removeData(g.typeahead).removeData(g.www).removeData(g.attr).removeClass(n.classes.input),i.length&&(t.detach().insertAfter(i),i.remove())}function d(n){var i,r;return i=e.isJQuery(n)||e.isElement(n),r=i?t(n).first():[],r.length?r:null}var p,g,m;p=t.fn.typeahead,g={www:"tt-www",attrs:"tt-attrs",typeahead:"tt-typeahead"},m={initialize:function(r,l){function f(){var n,f,m,y,v,_,b,w,S,x,A;e.each(l,function(t){t.highlight=!!r.highlight}),n=t(this),f=t(p.html.wrapper),m=d(r.hint),y=d(r.menu),v=!1!==r.hint&&!m,_=!1!==r.menu&&!y,v&&(m=s(n,p)),_&&(y=t(p.html.menu).css(p.css.menu)),m&&m.val(""),n=u(n,p),(v||_)&&(f.css(p.css.wrapper),n.css(v?p.css.input:p.css.inputWithNoHint),n.wrap(f).parent().prepend(v?m:null).append(_?y:null)),A=_?c:a,b=new i({el:n}),w=new o({hint:m,input:n},p),S=new A({node:y,datasets:l},p),x=new h({input:w,menu:S,eventBus:b,minLength:r.minLength},p),n.data(g.www,p),n.data(g.typeahead,x)}var p;return l=e.isArray(l)?l:[].slice.call(arguments,1),r=r||{},p=n(r.classNames),this.each(f)},isEnabled:function(){var t;return r(this.first(),function(e){t=e.isEnabled()}),t},enable:function(){return r(this,function(t){t.enable()}),this},disable:function(){return r(this,function(t){t.disable()}),this},isActive:function(){var t;return r(this.first(),function(e){t=e.isActive()}),t},activate:function(){return r(this,function(t){t.activate()}),this},deactivate:function(){return r(this,function(t){t.deactivate()}),this},isOpen:function(){var t;return r(this.first(),function(e){t=e.isOpen()}),t},open:function(){return r(this,function(t){t.open()}),this},close:function(){return r(this,function(t){t.close()}),this},select:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.select(i)}),n},autocomplete:function(e){var n=!1,i=t(e);return r(this.first(),function(t){n=t.autocomplete(i)}),n},moveCursor:function(t){var e=!1;return r(this.first(),function(n){e=n.moveCursor(t)}),e},val:function(t){var e;return arguments.length?(r(this,function(e){e.setVal(t)}),this):(r(this.first(),function(t){e=t.getVal()}),e)},destroy:function(){return r(this,function(t,e){f(e),t.destroy()}),this}},t.fn.typeahead=function(t){return m[t]?m[t].apply(this,[].slice.call(arguments,1)):m.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=p,this}}()});
!function(e,t){var n=t.jQuery;"object"==typeof exports?module.exports=n?e(t,n):function(n){if(n&&!n.fn)throw"Provide jQuery or null";return e(t,n)}:"function"==typeof define&&define.amd?define(function(){return e(t)}):e(t,!1)}(function(e,t){"use strict";function n(e,t){return function(){var n,r=this,i=r.base;return r.base=e,n=t.apply(r,arguments),r.base=i,n}}function r(e,t){return ne(t)&&(t=n(e?e._d?e:n(a,e):a,t),t._d=1),t}function i(e,t){for(var n in t.props)!$e.test(n)||e[n]&&e[n].fix||(e[n]=r(e.constructor.prototype[n],t.props[n]))}function o(e){return e}function a(){return""}function s(e){try{throw console.log("JsRender dbg breakpoint: "+e),"dbg breakpoint"}catch(e){}return this.base?this.baseApply(arguments):e}function d(e){this.name=(t.link?"JsViews":"JsRender")+" Error",this.message=e||this.name}function l(e,t){for(var n in t)e[n]=t[n];return e}function u(e,t,n){return e?re(e)?u.apply(ee,e):(le.delimiters=[e,t,he=n?n.charAt(0):he],ce=e.charAt(0),fe=e.charAt(1),ge=t.charAt(0),ve=t.charAt(1),e="\\"+ce+"(\\"+he+")?\\"+fe,t="\\"+ge+"\\"+ve,X="(?:(\\w+(?=[\\/\\s\\"+ge+"]))|(\\w+)?(:)|(>)|(\\*))\\s*((?:[^\\"+ge+"]|\\"+ge+"(?!\\"+ve+"))*?)",de.rTag="(?:"+X+")",X=new RegExp("(?:"+e+X+"(\\/)?|\\"+ce+"(\\"+he+")?\\"+fe+"(?:(?:\\/(\\w+))\\s*|!--[\\s\\S]*?--))"+t,"g"),de.rTmpl=new RegExp("^\\s|\\s$|<.*>|([^\\\\]|^)[{}]|"+e+".*"+t),pe):le.delimiters}function p(e,t){t||!0===e||(t=e,e=void 0);var n,r,i,o,a=this,s=!t||"root"===t;if(e){if(!(o=t&&a.type===t&&a))if(n=a.views,a._.useKey){for(r in n)if(o=t?n[r].get(e,t):n[r])break}else for(r=0,i=n.length;!o&&r<i;r++)o=t?n[r].get(e,t):n[r]}else if(s)for(;a.parent;)o=a,a=a.parent;else for(;a&&!o;)o=a.type===t?a:void 0,a=a.parent;return o}function c(){var e=this.get("item");return e?e.index:void 0}function f(){return this.index}function g(t,n){var r,i,o=this,a=o.ctx;if(a&&(a=a[t]),void 0===a&&(a=ae[t]),a&&a._cp){if(n)return i=a[1]?de._ceo(a[1].deps):["_jsvCp"],i.unshift(a[0]),i._cp=a._cp,i;a=ee.getCtx(a)}return a&&ne(a)&&!a._wrp&&(r=function(){return a.apply(this&&this!==e?this:o,arguments)},r._wrp=o,l(r,a)),r||a}function v(e){return e&&(e.fn?e:this.getRsc("templates",e)||ie(e))}function h(e,t,n,r){var o,a,s="number"==typeof n&&t.tmpl.bnds[n-1],d=t.linkCtx;return void 0===r&&s&&s._lr&&(r=""),void 0!==r?n=r={props:{},args:[r]}:s&&(n=s(t.data,t,de)),s=s._bd&&s,a=n.args[0],(e||s)&&(o=d&&d.tag,n.view=t,o||(o=l(new de._tg,{_:{inline:!d,bnd:s,unlinked:!0},tagName:":",cvt:e,flow:!0,tagCtx:n}),d&&(d.tag=o,o.linkCtx=d),n.ctx=Q(n.ctx,(d?d.view:t).ctx),i(o,n)),o._er=r&&a,o.ctx=n.ctx||o.ctx||{},n.ctx=void 0,a=o.cvtArgs("true"!==e&&e)[0]),a=s&&t._.onRender?t._.onRender(a,t,o):a,void 0!=a?a:""}function m(e,t){var n,r,i,o=this,a=o.tagCtx,s=a.args,d=o.bindTo;if(e=e||o.convert,""+e===e&&(e=a.view.getRsc("converters",e)||P("Unknown converter: '"+e+"'")),s.length||!1===o.argDefault||a.index?e&&!t&&(s=s.slice()):s=[a.view.data],d){for(i=[],n=d.length;n--;)r=d[n],i.unshift(w(a,r));t&&(s=i)}if(e)if(d=d||[0],e=e.apply(o,i||s),n=d.length,n<2&&(e=[e]),t)s=e;else for(;n--;)+(r=d[n])===r&&(s[r]=e?e[n]:void 0);return s}function w(e,t){return(e=e[+t===t?"args":"props"])&&e[t]}function x(){return this.cvtArgs(void 0,!0)}function _(e,t){for(var n,r,i=this;void 0===n&&i;)r=i.tmpl&&i.tmpl[e],n=r&&r[t],i=i.parent;return n||ee[e][t]}function b(e,t,n,r){e.ctx[n]=de._cp(w(e,t),w(e.params,t),e.view,r)}function y(e,n,r,o,a,s){n=n||Y;var d,l,u,p,c,f,g,v,h,m,w,x,_,y,k,j,C,T,A,R,V,$=0,M="",N=n.linkCtx||0,E=n.ctx,I=r||n.tmpl,O="number"==typeof o&&n.tmpl.bnds[o-1];for("tag"===e._is?(d=e,e=d.tagName,o=d.tagCtxs,d.template):(l=n.getRsc("tags",e)||P("Unknown tag: {{"+e+"}} "),l.template),void 0===s&&O&&O._lr&&(s=""),void 0!==s?(M+=s,o=s=[{props:{},args:[]}]):O&&(o=O(n.data,n,de)),f=o.length;$<f;$++)h=o[$],(!N||!N.tag||$&&!N.tag._.inline||d._er)&&((_=I.tmpls&&h.tmpl)&&(_=h.content=I.tmpls[_-1]),h.index=$,h.tmpl=_,h.render=S,h.view=n,h.ctx=Q(h.ctx,E)),(r=h.props.tmpl)&&(h.tmpl=n.getTmpl(r)),d||(d=new l._ctr,y=!!d.init,d.parent=c=E&&E.tag,d.tagCtxs=o,A=d.dataMap,N&&(d._.inline=!1,N.tag=d,d.linkCtx=N),(d._.bnd=O||N.fn)?d._.arrVws={}:d.dataBoundOnly&&P("{^{"+e+"}} tag must be data-bound")),x=d.bindTo||[0],o=d.tagCtxs,A=d.dataMap,h.tag=d,A&&o&&(h.map=o[$].map),d.flow||(m=h.ctx=h.ctx||{},u=d.parents=m.parentTags=E&&Q(m.parentTags,E.parentTags)||{},c&&(u[c.tagName]=c),u[d.tagName]=m.tag=d);if(!(d._er=s)){for(i(d,o[0]),d.rendering={},$=0;$<f;$++){if(h=d.tagCtx=o[$],T=h.props,d.ctx=h.ctx,$||(y&&(d.template,d.init(h,N,d.ctx),y=void 0),N&&(N.attr=d.attr=N.attr||d.attr),p=d.attr,d._.noVws=p&&p!==Fe),C=d.cvtArgs(),d.linkedCtxParam)for(g=x.length;g--;)(w=d.linkedCtxParam[g])&&(V=x[g],b(h,V,w,{tag:d,ind:g}));(k=T.dataMap||A)&&(C.length||T.dataMap)&&(j=h.map,j&&j.src===C[0]&&!a||(j&&j.src&&j.unmap(),j=h.map=k.map(C[0],T,void 0,!d._.bnd)),C=[j.tgt]),v=void 0,d.render&&(v=d.render.apply(d,C),n.linked&&v&&d.linkedElem&&!Me.test(v)&&(v=F(t.templates(v),C[0],void 0,void 0,n,void 0,void 0,d))),C.length||(C=[n]),void 0===v&&(R=C[0],d.contentCtx&&(R=!0===d.contentCtx?n:d.contentCtx(R)),v=h.render(R,!0)||(a?void 0:"")),M=M?M+(v||""):v}d.rendering=void 0}return d.tagCtx=o[0],d.ctx=d.tagCtx.ctx,d._.noVws&&d._.inline&&(M="text"===p?oe.html(M):""),O&&n._.onRender?n._.onRender(M,n,d):M}function k(e,t,n,r,i,o,a,s){var d,l,u,p=this,f="array"===t;p.content=s,p.views=f?[]:{},p.parent=n,p.type=t||"top",p.data=r,p.tmpl=i,u=p._={key:0,useKey:f?0:1,id:""+Ee++,onRender:a,bnds:{}},p.linked=!!a,n?(d=n.views,l=n._,l.useKey?(d[u.key="_"+l.useKey++]=p,p.index=Ue,p.getIndex=c):d.length===(u.key=p.index=o)?d.push(p):d.splice(o,0,p),p.ctx=e||n.ctx):p.ctx=e}function j(e){var t,n,r;for(t in Be)n=t+"s",e[n]&&(r=e[n],e[n]={},ee[n](r,e))}function C(e,t,n){function i(){var t=this;t._={inline:!0,unlinked:!0},t.tagName=e}function o(e){var n;(n=t[e])&&(t[e]=n=re(n)?n:[n],(c||1)!==n.length&&P(e+" length not same as bindTo "))}var a,s,d,u,p,c,f=t.bindTo,g=new de._tg;if(ne(t)?t={depends:t.depends,render:t}:""+t===t&&(t={template:t}),void 0!==f)for(f=t.bindTo=re(f)?f:[f],u=c=f.length;u--;)p=f[u],isNaN(parseInt(p))||(p=parseInt(p)),f[u]=p;if(o("linkedElement"),o("linkedCtxParam"),s=t.baseTag){t.flow=!!t.flow,t.baseTag=s=""+s===s?n&&n.tags[s]||se[s]:s,g=l(g,s);for(d in t)g[d]=r(s[d],t[d])}else g=l(g,t);return void 0!==(a=g.template)&&(g.template=""+a===a?ie[a]||ie(a):a),(i.prototype=g).constructor=g._ctr=i,n&&(g._parentTmpl=n),g}function T(e){return this.base.apply(this,e)}function A(e,n,r,i){function o(n){var o,s;if(""+n===n||n.nodeType>0&&(a=n)){if(!a)if(/^\.\/[^\\:*?"<>]*$/.test(n))(s=ie[e=e||n])?n=s:a=document.getElementById(n);else if(t.fn&&!de.rTmpl.test(n))try{a=t(n,document)[0]}catch(e){}a&&(i?n=a.innerHTML:(o=a.getAttribute(Pe),o&&(o!==Oe?(n=ie[o],delete ie[o]):t.fn&&(n=t.data(a)[Oe])),o&&n||(e=e||(t.fn?Oe:n),n=A(e,a.innerHTML,r,i)),n.tmplName=e=e||o,e!==Oe&&(ie[e]=n),a.setAttribute(Pe,e),t.fn&&t.data(a,Oe,n))),a=void 0}else n.fn||(n=void 0);return n}var a,s,d=n=n||"";if(0===i&&(i=void 0,d=o(d)),i=i||(n.markup?n:{}),i.tmplName=e,r&&(i._parentTmpl=r),!d&&n.markup&&(d=o(n.markup))&&d.fn&&(d=d.markup),void 0!==d)return d.fn||n.fn?d.fn&&(s=d):(n=M(d,i),U(d.replace(je,"\\$&"),n)),s||(s=l(function(){return s.render.apply(s,arguments)},n),j(s)),s}function R(e,t){return ne(e)?e.call(t):e}function V(e){for(var t=[],n=0,r=e.length;n<r;n++)t.push(e[n].unmap());return t}function $(e,n){function r(e){u.apply(this,e)}function i(){return new r(arguments)}function o(e,t){for(var n,r,i,o,a=0;a<w;a++)i=c[a],n=void 0,i+""!==i&&(n=i,i=n.getter),void 0===(o=e[i])&&n&&void 0!==(r=n.defaultVal)&&(o=R(r,e)),t(o,n&&p[n.type],i)}function a(t){t=t+""===t?JSON.parse(t):t;var n,r,i=0,a=t,l=[];if(re(t)){for(t=t||[],n=t.length;i<n;i++)l.push(this.map(t[i]));return l._is=e,l.unmap=d,l.merge=s,l}if(t){o(t,function(e,t){t&&(e=t.map(e)),l.push(e)}),a=this.apply(this,l);for(r in t)r===te||_[r]||(a[r]=t[r])}return a}function s(e){e=e+""===e?JSON.parse(e):e;var t,n,r,a,s,d,l,u,p,c=0,f=this;if(re(f)){for(l={},p=[],n=e.length,r=f.length;c<n;c++){for(u=e[c],d=!1,t=0;t<r&&!d;t++)l[t]||(s=f[t],g&&(l[t]=d=g+""===g?u[g]&&(_[g]?s[g]():s[g])===u[g]:g(s,u)));d?(s.merge(u),p.push(s)):p.push(i.map(u))}return void(x?x(f).refresh(p,!0):f.splice.apply(f,[0,f.length].concat(p)))}o(e,function(e,t,n){t?f[n]().merge(e):f[n](e)});for(a in e)a===te||_[a]||(f[a]=e[a])}function d(){var e,t,n,r,i=0,o=this;if(re(o))return V(o);for(e={};i<w;i++)t=c[i],n=void 0,t+""!==t&&(n=t,t=n.getter),r=o[t](),e[t]=n&&r&&p[n.type]?re(r)?V(r):r.unmap():r;for(t in o)"_is"===t||_[t]||t===te||"_"===t.charAt(0)&&_[t.slice(1)]||ne(o[t])||(e[t]=o[t]);return e}var l,u,p=this,c=n.getters,f=n.extend,g=n.id,v=t.extend({_is:e||"unnamed",unmap:d,merge:s},f),h="",m="",w=c?c.length:0,x=t.observable,_={};for(r.prototype=v,l=0;l<w;l++)!function(e){e=e.getter||e,_[e]=l+1;var t="_"+e;h+=(h?",":"")+e,m+="this."+t+" = "+e+";\n",v[e]=v[e]||function(n){return arguments.length?void(x?x(this).setProperty(e,n):this[t]=n):this[t]},x&&(v[e].set=v[e].set||function(e){this[t]=e})}(c[l]);return u=new Function(h,m.slice(0,-1)),u.prototype=v,v.constructor=u,i.map=a,i.getters=c,i.extend=f,i.id=g,i}function M(e,n){var r,i=ue._wm||{},o=l({tmpls:[],links:{},bnds:[],_is:"template",render:S},n);return o.markup=e,n.htmlTag||(r=Ae.exec(e),o.htmlTag=r?r[1].toLowerCase():""),r=i[o.htmlTag],r&&r!==i.div&&(o.markup=t.trim(o.markup)),o}function N(e){pe[e]=function(t){return arguments.length?(le[e]=t,pe):le[e]}}function E(e){function t(t,n){this.tgt=e.getTgt(t,n)}return ne(e)&&(e={getTgt:e}),e.baseMap&&(e=l(l({},e.baseMap),e)),e.map=function(e,n){return new t(e,n)},e}function S(e,t,n,r,i,o){var a,s,d,l,u,p,c,f,g=r,v="";if(!0===t?(n=t,t=void 0):typeof t!==Ie&&(t=void 0),(d=this.tag)?(u=this,g=g||u.view,l=g.getTmpl(d.template||u.tmpl),arguments.length||(e=g)):l=this,l){if(!r&&e&&"view"===e._is&&(g=e),g&&e===g&&(e=g.data),p=!g,we=we||p,g||((t=t||{}).root=e),!we||ue.useViews||l.useViews||g&&g!==Y)v=F(l,e,t,n,g,i,o,d);else{if(g?(c=g.data,f=g.index,g.index=Ue):(g=Y,g.data=e,g.ctx=t),re(e)&&!n)for(a=0,s=e.length;a<s;a++)g.index=a,g.data=e[a],v+=l.fn(e[a],g,de);else g.data=e,v+=l.fn(e,g,de);g.data=c,g.index=f}p&&(we=void 0)}return v}function F(e,t,n,r,i,o,a,s){function d(e){_=l({},n),_[x]=e}var u,p,c,f,g,v,h,m,w,x,_,b,y="";if(s&&(w=s.tagName,b=s.tagCtx,n=n?Q(n,s.ctx):s.ctx,e===i.content?h=e!==i.ctx._wrp?i.ctx._wrp:void 0:e!==b.content?e===s.template?(h=b.tmpl,n._wrp=b.content):h=b.content||i.content:h=i.content,!1===b.props.link&&(n=n||{},n.link=!1),(x=b.props.itemVar)&&("~"!==x.charAt(0)&&O("Use itemVar='~myItem'"),x=x.slice(1))),i&&(a=a||i._.onRender,n=Q(n,i.ctx)),!0===o&&(v=!0,o=0),a&&(n&&!1===n.link||s&&s._.noVws)&&(a=void 0),m=a,!0===a&&(m=void 0,a=i._.onRender),n=e.helpers?Q(e.helpers,n):n,_=n,re(t)&&!r)for(c=v?i:void 0!==o&&i||new k(n,"array",i,t,e,o,a,h),i&&i._.useKey&&(c._.bnd=!s||s._.bnd&&s),x&&(c.it=x),x=c.it,u=0,p=t.length;u<p;u++)x&&d(t[u]),f=new k(_,"item",c,t[u],e,(o||0)+u,a,c.content),g=e.fn(t[u],f,de),y+=c._.onRender?c._.onRender(g,f):g;else x&&d(t),c=v?i:new k(_,w||"data",i,t,e,o,a,h),s&&!s.flow&&(c.tag=s,s.view=c),y+=e.fn(t,c,de);return m?m(y,c):y}function I(e,t,n){var r=void 0!==n?ne(n)?n.call(t.data,e,t):n||"":"{Error: "+(e.message||e)+"}";return le.onError&&void 0!==(n=le.onError.call(t.data,e,n&&r,t))&&(r=n),t&&!t.linkCtx?oe.html(r):r}function P(e){throw new de.Err(e)}function O(e){P("Syntax error\n"+e)}function U(e,t,n,r,i){function o(t){(t-=v)&&m.push(e.substr(v,t).replace(ye,"\\n"))}function a(t,n){t&&(t+="}}",O((n?"{{"+n+"}} block has {{/"+t+" without {{"+t:"Unmatched or missing {{/"+t)+", in template:\n"+e))}function s(s,d,l,c,g,x,_,b,y,k,j,C){(_&&d||y&&!l||b&&":"===b.slice(-1)||k)&&O(s),x&&(g=":",c=Fe),y=y||n&&!i;var T,A=(d||n)&&[[]],R="",V="",$="",M="",N="",E="",S="",F="",I=!y&&!g;l=l||(b=b||"#data",g),o(C),v=C+s.length,_?f&&m.push(["*","\n"+b.replace(/^:/,"ret+= ").replace(ke,"$1")+";\n"]):l?("else"===l&&(Te.test(b)&&O('for "{{else if expr}}" use "{{else expr}}"'),A=w[8]&&[[]],w[9]=e.substring(w[9],C),w=h.pop(),m=w[2],I=!0),b&&B(b.replace(ye," "),A,t).replace(Ce,function(e,t,n,r,i,o,a,s){return r="'"+i+"':",a?(V+=o+",",M+="'"+s+"',"):n?($+=r+"j._cp("+o+',"'+s+'",view),',E+=r+"'"+s+"',"):t?S+=o:("trigger"===i&&(F+=o),"lateRender"===i&&(T=1),R+=r+o+",",N+=r+"'"+s+"',",p=p||$e.test(i)),""}).slice(0,-1),A&&A[0]&&A.pop(),u=[l,c||!!r||p||"",I&&[],J(M||(":"===l?"'#data',":""),N,E),J(V||(":"===l?"data,":""),R,$),S,F,T,A||0],m.push(u),I&&(h.push(w),w=u,w[9]=v)):j&&(a(j!==w[0]&&"else"!==w[0]&&j,w[0]),w[9]=e.substring(w[9],C),w=h.pop()),a(!w&&j),m=w[2]}var d,l,u,p,c,f=le.allowCode||t&&t.allowCode||!0===pe.allowCode,g=[],v=0,h=[],m=g,w=[,,g];if(f&&t._is&&(t.allowCode=f),n&&(void 0!==r&&(e=e.slice(0,-r.length-2)+ge),e=ce+e+ve),a(h[0]&&h[0][2].pop()[0]),e.replace(X,s),o(e.length),(v=g[g.length-1])&&a(""+v!==v&&+v[9]===v[9]&&v[0]),n){for(l=L(g,e,n),c=[],d=g.length;d--;)c.unshift(g[d][8]);q(l,c)}else l=L(g,t);return l}function q(e,t){var n,r,i=0,o=t.length;for(e.deps=[],e.paths=[];i<o;i++){e.paths.push(r=t[i]);for(n in r)"_jsvto"!==n&&r.hasOwnProperty(n)&&r[n].length&&!r[n].skp&&(e.deps=e.deps.concat(r[n]))}}function J(e,t,n){return[e.slice(0,-1),t.slice(0,-1),n.slice(0,-1)]}function K(e,t){return"\n\t"+(t?t+":{":"")+"args:["+e[0]+"]"+(e[1]||!t?",\n\tprops:{"+e[1]+"}":"")+(e[2]?",\n\tctx:{"+e[2]+"}":"")}function B(e,t,n){function r(r,m,w,x,_,b,y,k,j,C,T,A,R,V,$,M,N,E,S,F){function I(e,n,r,a,s,d,p,c){var f="."===r;if(r&&(_=_.slice(n.length),/^\.?constructor$/.test(c||_)&&O(e),f||(e=(a?'view.hlp("'+a+'")':s?"view":"data")+(c?(d?"."+d:a?"":s?"":"."+r)+(p||""):(c=a?"":s?d||"":r,"")),e+=c?"."+c:"",e=n+("view.data"===e.slice(0,9)?e.slice(5):e)),l)){if(J="linkTo"===i?o=t._jsvto=t._jsvto||[]:u.bd,K=f&&J[J.length-1]){if(K._jsv){for(;K.sb;)K=K.sb;K.bnd&&(_="^"+_.slice(1)),K.sb=_,K.bnd=K.bnd||"^"===_.charAt(0)}}else J.push(_);h[g]=S+(f?1:0)}return e}x&&!k&&(_=x+_),b=b||"",w=w||m||A,_=_||j,C=C||N||"";var P,q,J,K,B,L=")";if("["===C&&(C="[j._sq(",L=")]"),!y||d||s){if(l&&M&&!d&&!s&&(!i||a||o)&&(P=h[g-1],F.length-1>S-(P||0))){if(P=F.slice(P,S+r.length),!0!==q)if(J=o||p[g-1].bd,(K=J[J.length-1])&&K.prm){for(;K.sb&&K.sb.prm;)K=K.sb;B=K.sb={path:K.sb,bnd:K.bnd}}else J.push(B={path:J.pop()});M=fe+":"+P+" onerror=''"+ge,q=f[M],q||(f[M]=!0,f[M]=q=U(M,n,!0)),!0!==q&&B&&(B._jsv=q,B.prm=u.bd,B.bnd=B.bnd||B.path&&B.path.indexOf("^")>=0)}return d?(d=!R,d?r:A+'"'):s?(s=!V,s?r:A+'"'):(w?(h[g]=S++,u=p[++g]={bd:[]},w):"")+(E?g?"":(c=F.slice(c,S),(i?(i=a=o=!1,"\b"):"\b,")+c+(c=S+r.length,l&&t.push(u.bd=[]),"\b")):k?(g&&O(e),l&&t.pop(),i=_,a=x,c=S+r.length,l&&(l=u.bd=t[i]=[],l.skp=!x),_+":"):_?_.split("^").join(".").replace(_e,I)+(C?(u=p[++g]={bd:[]},v[g]=L,C):b):b||($?($=v[g]||$,v[g]=!1,u=p[--g],$+(C?(u=p[++g],v[g]=L,C):"")):T?(v[g]||O(e),","):m?"":(d=R,s=V,'"')))}O(e)}var i,o,a,s,d,l=t&&t[0],u={bd:l},p={0:u},c=0,f=(n?n.links:l&&(l.links=l.links||{}))||Y.tmpl.links,g=0,v={},h={},m=(e+(n?" ":"")).replace(be,r);return!g&&m||O(e)}function L(e,t,n){var r,i,o,a,s,d,l,u,p,c,f,g,v,h,m,w,x,_,b,y,k,j,C,T,A,R,V,$,N,E,S=0,F=ue.useViews||t.useViews||t.tags||t.templates||t.helpers||t.converters,I="",P={},U=e.length;for(""+t===t?(x=n?'data-link="'+t.replace(ye," ").slice(1,-1)+'"':t,t=0):(x=t.tmplName||"unnamed",t.allowCode&&(P.allowCode=!0),t.debug&&(P.debug=!0),c=t.bnds,w=t.tmpls),r=0;r<U;r++)if(""+(i=e[r])===i)I+='\n+"'+i+'"';else if("*"===(o=i[0]))I+=";\n"+i[1]+"\nret=ret";else{if(a=i[1],y=!n&&i[2],s=K(i[3],"params")+"},"+K(g=i[4]),V=i[5],N=i[6],E=i[7],k=i[9]&&i[9].replace(ke,"$1"),(T="else"===o)?f&&f.push(i[8]):c&&(f=i[8])&&(f=[f],S=c.push(1)),F=F||g[1]||g[2]||f||/view.(?!index)/.test(g[0]),(A=":"===o)?a&&(o=a===Fe?">":a+o):(y&&(_=M(k,P),_.tmplName=x+"/"+o,_.useViews=_.useViews||F,L(y,_),F=_.useViews,w.push(_)),T||(b=o,F=F||o&&(!se[o]||!se[o].flow),C=I,I=""),j=e[r+1],j=j&&"else"===j[0]),$=V?";\ntry{\nret+=":"\n+",v="",h="",A&&(f||N||a&&a!==Fe||E)){if(R=new Function("data,view,j,u","// "+x+" "+ ++S+" "+o+"\nreturn {"+s+"};"),R._er=V,R._tag=o,R._bd=!!f,R._lr=E,n)return R;q(R,f),m='c("'+a+'",view,',p=!0,v=m+S+",",h=")"}if(I+=A?(n?(V?"try{\n":"")+"return ":$)+(p?(p=void 0,F=u=!0,m+(R?(c[S-1]=R,S):"{"+s+"}")+")"):">"===o?(l=!0,"h("+g[0]+")"):(!0,"((v="+g[0]+")!=null?v:"+(n?"null)":'"")'))):(d=!0,"\n{view:view,tmpl:"+(y?w.length:"0")+","+s+"},"),b&&!j){if(I="["+I.slice(0,-1)+"]",m='t("'+b+'",view,this,',n||f){if(I=new Function("data,view,j,u"," // "+x+" "+S+" "+b+"\nreturn "+I+";"),I._er=V,I._tag=b,f&&q(c[S-1]=I,f),I._lr=E,n)return I;v=m+S+",undefined,",h=")"}I=C+$+m+(I.deps&&S||I)+")",f=0,b=0}V&&(F=!0,I+=";\n}catch(e){ret"+(n?"urn ":"+=")+v+"j._err(e,view,"+V+")"+h+";}"+(n?"":"ret=ret"))}I="// "+x+"\nvar v"+(d?",t=j._tag":"")+(u?",c=j._cnvt":"")+(l?",h=j._html":"")+(n?";\n":',ret=""\n')+(P.debug?"debugger;":"")+I+(n?"\n":";\nreturn ret;"),!1!==le.debugMode&&(I="try {\n"+I+"\n}catch(e){\nreturn j._err(e, view);\n}");try{I=new Function("data,view,j,u",I)}catch(e){O("Compiled template code:\n\n"+I+'\n: "'+(e.message||e)+'"')}return t&&(t.fn=I,t.useViews=!!F),I}function Q(e,t){return e&&e!==t?t?l(l({},t),e):e:t&&l({},t)}function H(e){return Se[e]||(Se[e]="&#"+e.charCodeAt(0)+";")}function D(e){var t,n,r=[];if(typeof e===Ie)for(t in e)n=e[t],t!==te&&e.hasOwnProperty(t)&&!ne(n)&&r.push({key:t,prop:n});return r}function Z(e,n,r){var i=this.jquery&&(this[0]||P("Unknown template")),o=i.getAttribute(Pe);return S.call(o&&t.data(i)[Oe]||ie(i),e,n,r)}function z(e){return void 0!=e?Ve.test(e)&&(""+e).replace(Ne,H)||e:""}var G=!1===t;t=t&&t.fn?t:e.jQuery;var W,X,Y,ee,te,ne,re,ie,oe,ae,se,de,le,ue,pe,ce,fe,ge,ve,he,me,we,xe="v0.9.85",_e=/^(!*?)(?:null|true|false|\d[\d.]*|([\w$]+|\.|~([\w$]+)|#(view|([\w$]+))?)([\w$.^]*?)(?:[.[^]([\w$]+)\]?)?)$/g,be=/(\()(?=\s*\()|(?:([([])\s*)?(?:(\^?)(!*?[#~]?[\w$.^]+)?\s*((\+\+|--)|\+|-|&&|\|\||===|!==|==|!=|<=|>=|[<>%*:?\/]|(=))\s*|(!*?[#~]?[\w$.^]+)([([])?)|(,\s*)|(\(?)\\?(?:(')|("))|(?:\s*(([)\]])(?=\s*[.^]|\s*$|[^([])|[)\]])([([]?))|(\s+)/g,ye=/[ \t]*(\r\n|\n|\r)/g,ke=/\\(['"])/g,je=/['"\\]/g,Ce=/(?:\x08|^)(onerror:)?(?:(~?)(([\w$_\.]+):)?([^\x08]+))\x08(,)?([^\x08]+)/gi,Te=/^if\s/,Ae=/<(\w+)[>\s]/,Re=/[\x00`><"'&=]/g,Ve=/[\x00`><\"'&=]/,$e=/^on[A-Z]|^convert(Back)?$/,Me=/^\#\d+_`[\s\S]*\/\d+_`$/,Ne=Re,Ee=0,Se={"&":"&amp;","<":"&lt;",">":"&gt;","\0":"&#0;","'":"&#39;",'"':"&#34;","`":"&#96;","=":"&#61;"},Fe="html",Ie="object",Pe="data-jsv-tmpl",Oe="jsvTmpl",Ue="For #index in nested block use #getIndex().",qe={},Je=e.jsrender,Ke=Je&&t&&!t.render,Be={template:{compile:A},tag:{compile:C},viewModel:{compile:$},helper:{},converter:{}};if(ee={jsviews:xe,sub:{View:k,Err:d,tmplFn:U,parse:B,extend:l,extendCtx:Q,syntaxErr:O,onStore:{template:function(e,t){null===t?delete qe[e]:qe[e]=t}},addSetting:N,settings:{allowCode:!1},advSet:a,_ths:i,_gm:r,_tg:function(){},_cnvt:h,_tag:y,_er:P,_err:I,_html:z,_cp:o,_sq:function(e){return"constructor"===e&&O(""),e}},settings:{delimiters:u,advanced:function(e){return e?(l(ue,e),de.advSet(),pe):ue}},getCtx:o,map:E},(d.prototype=new Error).constructor=d,c.depends=function(){return[this.get("item"),"index"]},f.depends="index",k.prototype={get:p,getIndex:f,getRsc:_,getTmpl:v,hlp:g,_is:"view"},de=ee.sub,pe=ee.settings,!(Je||t&&t.render)){for(W in Be)!function(e,t){function n(i,o,a){var s,d,l,u=de.onStore[e];if(i&&typeof i===Ie&&!i.nodeType&&!i.markup&&!i.getTgt&&!("viewModel"===e&&i.getters||i.extend)){for(d in i)n(d,i[d],o);return o||ee}return void 0===o&&(o=i,i=void 0),i&&""+i!==i&&(a=o,o=i,i=void 0),l=a?"viewModel"===e?a:a[r]=a[r]||{}:n,s=t.compile,null===o?i&&delete l[i]:(s&&(o=s.call(l,i,o,a,0),o._is=e),i&&(l[i]=o)),u&&u(i,o,a,s),o}var r=e+"s";ee[r]=n}(W,Be[W]);oe=ee.converters,ae=ee.helpers,se=ee.tags,de._tg.prototype={baseApply:T,cvtArgs:m,bndArgs:x},Y=de.topView=new k,t?(t.fn.render=Z,te=t.expando,t.observable&&(l(de,t.views.sub),ee.map=t.views.map)):(t={},G&&(e.jsrender=t),t.renderFile=t.__express=t.compile=function(){throw"Node.js: use npm jsrender, or jsrender-node.js"},t.isFunction=function(e){return"function"==typeof e},t.isArray=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)},de._jq=function(e){e!==t&&(l(e,t),t=e,t.fn.render=Z,delete t.jsrender,te=t.expando)},t.jsrender=xe),le=de.settings,le.allowCode=!1,ne=t.isFunction,t.render=qe,t.views=ee,t.templates=ie=ee.templates;for(me in le)N(me);(pe.debugMode=function(e){return void 0===e?le.debugMode:(le.debugMode=e,le.onError=e+""===e?new Function("","return '"+e+"';"):ne(e)?e:void 0,pe)})(!1),ue=le.advanced={useViews:!1,_jsv:!1},se({if:{render:function(e){var t=this,n=t.tagCtx;return t.rendering.done||!e&&(arguments.length||!n.index)?"":(t.rendering.done=!0,t.selected=n.index,n.render(n.view,!0))},flow:!0},for:{render:function(e){var t,n=!arguments.length,r=this,i=r.tagCtx,o="",a=0;return r.rendering.done||(t=n?i.view.data:e,void 0!==t&&(o+=i.render(t,n),a+=re(t)?t.length:1),(r.rendering.done=a)&&(r.selected=i.index)),o},flow:!0},props:{baseTag:"for",dataMap:E(D),flow:!0},include:{flow:!0},"*":{render:o,flow:!0},":*":{render:o,flow:!0},dbg:ae.dbg=oe.dbg=s}),oe({html:z,attr:z,url:function(e){return void 0!=e?encodeURI(""+e):null===e?e:""}})}return le=de.settings,re=(t||Je).isArray,pe.delimiters("{{","}}","^"),Ke&&Je.views.sub._jq(t),t||Je},window);
!function(t){(function(t){t.extend({tips:function(e){var n,o,i;return o={action:"focus",element:".error",fadeSpeed:200,removeSpecific:!1,tailLength:14,tooltipClass:""},o=t.extend(o,e),i=function(e){var i,a,c,r,s,u,f,l,d,p;if(e.attr("data-tooltip"))switch(n(),r=e.attr("data-tooltip"),i=e.attr("data-tooltip-direction"),t("<div>").addClass("t-tip "+o.tooltipClass).html(r).appendTo("body"),c=e.outerWidth(),a=e.outerHeight(),d=t(".t-tip:last").outerWidth(),l=t(".t-tip:last").outerHeight(),u=e.offset(),p=u.top,s=0,f=0,i){case"left":f=u.left-d-o.tailLength,p=p-l/2+a/2,t(".t-tip:last").css({left:f,top:p}).addClass("left").fadeIn(o.fadeSpeed);break;case"bottom":p=u.top+a+o.tailLength,s=u.left+c/2-d/2,t(".t-tip:last").css({left:s,top:p}).addClass("bottom").fadeIn(o.fadeSpeed);break;case"top":p=u.top-l-o.tailLength,s=u.left+c/2-d/2,t(".t-tip:last").css({left:s,top:p}).addClass("top").fadeIn(o.fadeSpeed);break;default:s=u.left+c+o.tailLength,p=p-l/2+a/2,t(".t-tip:last").css({left:s,top:p}).fadeIn(o.fadeSpeed)}},n=function(){return t(".t-tip").fadeOut(o.fadeSpeed,function(){return t(this).remove()})},this(function(){var e;switch(e=o.element,o.action){case"click":return t(document).on("click",e,function(e){return e.preventDefault(),i(t(this))}),t(document).off("click.tips").on("click.tips",function(e){if(!t(e.target).hasClass("t-tip")&&!t(e.target).closest("[data-tooltip]").length)return n()});case"hover":return t(document).on("click.tips.hc",e,function(t){return t.preventDefault()}),t(document).on("mouseenter.tips.he",e,function(e){return i(t(this))}),t(document).on("mouseout.tips.ho",e,function(t){return n()});default:return t(document).on("click.tips.fc",e,function(t){return t.preventDefault()}),t(document).on("focus.tips.ff",e,function(e){return i(t(this))}),t(document).on("blur.tips.fb",e,function(t){return n()}),t(document).on("change.tips.fch",e,function(t){return n()})}})}})})(jQuery)}();